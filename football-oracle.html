<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Football Oracle ‚Äî Top 5 Leagues Analytics</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Barlow+Condensed:wght@300;400;500;600;700;900&family=Barlow:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --pitch-dark: #0a1a0f;
    --pitch-mid: #0f2318;
    --pitch-green: #1a3a24;
    --pitch-line: #1e4d2b;
    --grass: #2d6a3f;
    --grass-light: #3d8a52;
    --gold: #f5c842;
    --gold-dim: #c9a228;
    --yellow-card: #f5c842;
    --red-card: #e63946;
    --red-dim: #9b2128;
    --white: #f0ede4;
    --white-dim: #a8a89a;
    --ink: #1a1a1a;
    --border: rgba(255,255,255,0.07);
    --card-bg: rgba(15,35,24,0.85);
    --card-hover: rgba(29,65,42,0.9);
    --shadow: 0 8px 32px rgba(0,0,0,0.5);
    --accent: #4ade80;
    --accent-dim: #22c55e;
    --pl: #3d0073;
    --ll: #d4000e;
    --sa: #0057a8;
    --bl: #d3010c;
    --l1: #003189;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Barlow', sans-serif;
    background: var(--pitch-dark);
    color: var(--white);
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
  }

  /* Pitch pattern background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: 
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 60px,
        rgba(255,255,255,0.012) 60px,
        rgba(255,255,255,0.012) 61px
      ),
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 60px,
        rgba(255,255,255,0.008) 60px,
        rgba(255,255,255,0.008) 61px
      );
    pointer-events: none;
    z-index: 0;
  }

  .grass-stripes {
    position: fixed;
    inset: 0;
    background: repeating-linear-gradient(
      to bottom,
      rgba(45, 106, 63, 0.04) 0px,
      rgba(45, 106, 63, 0.04) 80px,
      rgba(35, 85, 50, 0.06) 80px,
      rgba(35, 85, 50, 0.06) 160px
    );
    pointer-events: none;
    z-index: 0;
  }

  #app { position: relative; z-index: 1; }

  /* ===== HEADER ===== */
  .header {
    background: linear-gradient(180deg, rgba(0,0,0,0.9) 0%, rgba(10,26,15,0.95) 100%);
    border-bottom: 2px solid var(--gold);
    padding: 0 24px;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 4px 40px rgba(0,0,0,0.7);
  }

  .header-inner {
    max-width: 1600px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    gap: 20px;
    padding: 12px 0;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .logo-icon {
    width: 48px;
    height: 48px;
    position: relative;
    flex-shrink: 0;
  }

  .logo-icon svg { width: 100%; height: 100%; }

  .logo-text {
    font-family: 'Black Ops One', cursive;
    font-size: 1.9rem;
    color: var(--gold);
    letter-spacing: 1px;
    line-height: 1;
  }

  .logo-sub {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.7rem;
    font-weight: 500;
    letter-spacing: 4px;
    color: var(--white-dim);
    text-transform: uppercase;
  }

  .header-leagues {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    margin-left: auto;
  }

  .league-badge {
    padding: 4px 12px;
    border-radius: 3px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.78rem;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.2s;
    border: 1px solid transparent;
    opacity: 0.65;
  }
  .league-badge.active { opacity: 1; border-color: rgba(255,255,255,0.3); }
  .league-badge.pl { background: rgba(61,0,115,0.6); color: #c8a8ff; }
  .league-badge.pl.active { background: #3d0073; color: #fff; }
  .league-badge.ll { background: rgba(212,0,14,0.4); color: #ffaaaa; }
  .league-badge.ll.active { background: var(--ll); color: #fff; }
  .league-badge.sa { background: rgba(0,87,168,0.4); color: #aac8ff; }
  .league-badge.sa.active { background: var(--sa); color: #fff; }
  .league-badge.bl { background: rgba(211,1,12,0.4); color: #ffaaaa; }
  .league-badge.bl.active { background: var(--bl); color: #fff; box-shadow: 0 0 0 1px rgba(255,220,0,0.5);}
  .league-badge.l1 { background: rgba(0,49,137,0.4); color: #aabfff; }
  .league-badge.l1.active { background: var(--l1); color: #fff; }

  .live-pulse {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.75rem;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 600;
    letter-spacing: 2px;
    color: var(--accent);
    margin-left: 8px;
  }

  .pulse-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--accent);
    animation: pulse 1.5s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.3; transform: scale(0.7); }
  }

  /* ===== NAV TABS ===== */
  .nav-tabs {
    background: rgba(0,0,0,0.5);
    border-bottom: 1px solid var(--border);
    padding: 0 24px;
    position: sticky;
    top: 73px;
    z-index: 90;
    backdrop-filter: blur(10px);
  }

  .nav-tabs-inner {
    max-width: 1600px;
    margin: 0 auto;
    display: flex;
    gap: 0;
    overflow-x: auto;
    scrollbar-width: none;
  }

  .nav-tab {
    padding: 14px 22px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 600;
    font-size: 0.9rem;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--white-dim);
    cursor: pointer;
    border-bottom: 3px solid transparent;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .nav-tab:hover { color: var(--white); }
  .nav-tab.active { color: var(--gold); border-bottom-color: var(--gold); }

  /* ===== MAIN LAYOUT ===== */
  .main {
    max-width: 1600px;
    margin: 0 auto;
    padding: 24px;
  }

  /* ===== SECTION TITLE ===== */
  .section-header {
    display: flex;
    align-items: baseline;
    gap: 14px;
    margin-bottom: 20px;
  }

  .section-title {
    font-family: 'Black Ops One', cursive;
    font-size: 1.4rem;
    color: var(--white);
    letter-spacing: 1px;
  }

  .section-sub {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.8rem;
    font-weight: 500;
    letter-spacing: 3px;
    color: var(--white-dim);
    text-transform: uppercase;
  }

  /* ===== GRID ===== */
  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
  .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
  .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
  .grid-auto { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }

  @media (max-width: 1200px) {
    .grid-4 { grid-template-columns: repeat(2, 1fr); }
    .grid-3 { grid-template-columns: 1fr 1fr; }
  }
  @media (max-width: 768px) {
    .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
  }

  /* ===== CARDS ===== */
  .card {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 20px;
    transition: all 0.25s;
    position: relative;
    overflow: hidden;
  }

  .card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
    opacity: 0;
    transition: opacity 0.3s;
  }

  .card:hover { background: var(--card-hover); border-color: rgba(245,200,66,0.2); }
  .card:hover::before { opacity: 1; }

  .card-label {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.72rem;
    font-weight: 700;
    letter-spacing: 3px;
    color: var(--white-dim);
    text-transform: uppercase;
    margin-bottom: 8px;
  }

  .card-value {
    font-family: 'Black Ops One', cursive;
    font-size: 2.4rem;
    color: var(--white);
    line-height: 1;
    margin-bottom: 4px;
  }

  .card-value.gold { color: var(--gold); }
  .card-value.red { color: var(--red-card); }
  .card-value.green { color: var(--accent); }

  .card-detail {
    font-size: 0.8rem;
    color: var(--white-dim);
    font-family: 'Barlow', sans-serif;
  }

  /* ===== BOOKING CARD VISUAL ===== */
  .booking-card-visual {
    width: 28px;
    height: 38px;
    border-radius: 3px;
    display: inline-block;
    flex-shrink: 0;
    box-shadow: 2px 2px 6px rgba(0,0,0,0.5);
    position: relative;
  }
  .booking-card-visual.yellow { background: linear-gradient(135deg, #f5c842, #d4a820); }
  .booking-card-visual.red { background: linear-gradient(135deg, #e63946, #9b2128); }
  .booking-card-visual.both {
    background: linear-gradient(135deg, #f5c842 50%, #e63946 50%);
  }

  /* ===== FIXTURE CARD ===== */
  .fixture-card {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 16px 20px;
    transition: all 0.25s;
    cursor: pointer;
  }
  .fixture-card:hover { background: var(--card-hover); border-color: rgba(245,200,66,0.25); }

  .fixture-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
  }

  .fixture-league-tag {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.7rem;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 2px 8px;
    border-radius: 2px;
  }

  .fixture-date {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.78rem;
    color: var(--white-dim);
    letter-spacing: 1px;
  }

  .fixture-teams {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 14px;
  }

  .fixture-team {
    flex: 1;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1rem;
    letter-spacing: 0.5px;
  }

  .fixture-team.home { text-align: right; }
  .fixture-team.away { text-align: left; }

  .fixture-vs {
    font-family: 'Black Ops One', cursive;
    font-size: 0.85rem;
    color: var(--white-dim);
    padding: 4px 8px;
    background: rgba(255,255,255,0.05);
    border-radius: 3px;
    min-width: 50px;
    text-align: center;
  }

  .fixture-vs.result { color: var(--gold); font-size: 1rem; }

  .fixture-predictions {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
    border-top: 1px solid var(--border);
    padding-top: 12px;
  }

  .pred-item {
    text-align: center;
  }

  .pred-label {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.65rem;
    font-weight: 600;
    letter-spacing: 2px;
    color: var(--white-dim);
    text-transform: uppercase;
    margin-bottom: 3px;
  }

  .pred-value {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.92rem;
    color: var(--white);
  }

  .pred-value.highlight { color: var(--gold); }
  .pred-value.danger { color: var(--red-card); }

  /* ===== PROBABILITY BARS ===== */
  .prob-bar-container {
    display: flex;
    gap: 3px;
    height: 6px;
    border-radius: 3px;
    overflow: hidden;
    margin-top: 6px;
  }

  .prob-bar-h { background: var(--accent); transition: width 0.8s; border-radius: 3px 0 0 3px; }
  .prob-bar-d { background: var(--gold); transition: width 0.8s; }
  .prob-bar-a { background: var(--red-card); transition: width 0.8s; border-radius: 0 3px 3px 0; }

  .prob-labels {
    display: flex;
    justify-content: space-between;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.7rem;
    color: var(--white-dim);
    margin-top: 4px;
  }

  .prob-labels span:nth-child(1) { color: var(--accent); }
  .prob-labels span:nth-child(2) { color: var(--gold); }
  .prob-labels span:nth-child(3) { color: var(--red-card); }

  /* ===== TABLE ===== */
  .data-table {
    width: 100%;
    border-collapse: collapse;
    font-family: 'Barlow Condensed', sans-serif;
  }

  .data-table th {
    text-align: left;
    font-size: 0.68rem;
    font-weight: 700;
    letter-spacing: 2.5px;
    text-transform: uppercase;
    color: var(--white-dim);
    padding: 10px 12px;
    border-bottom: 1px solid var(--border);
  }

  .data-table th.num { text-align: center; }

  .data-table td {
    padding: 10px 12px;
    border-bottom: 1px solid rgba(255,255,255,0.04);
    font-size: 0.9rem;
    font-weight: 500;
    vertical-align: middle;
  }

  .data-table td.num { text-align: center; }

  .data-table tr:hover td { background: rgba(255,255,255,0.03); }

  .data-table tr.top-3 td:first-child { color: var(--gold); }

  .rank-num {
    font-family: 'Black Ops One', cursive;
    font-size: 1rem;
    color: var(--white-dim);
    min-width: 28px;
    text-align: center;
  }

  /* ===== BOOKING INDICATOR ===== */
  .booking-count {
    display: inline-flex;
    align-items: center;
    gap: 4px;
  }

  .card-icon {
    display: inline-block;
    width: 12px;
    height: 16px;
    border-radius: 1.5px;
  }
  .card-icon.y { background: var(--yellow-card); }
  .card-icon.r { background: var(--red-card); }

  /* ===== FORM DOTS ===== */
  .form-dots {
    display: flex;
    gap: 3px;
  }

  .form-dot {
    width: 20px;
    height: 20px;
    border-radius: 3px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.72rem;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .form-dot.W { background: rgba(74,222,128,0.2); color: var(--accent); border: 1px solid rgba(74,222,128,0.4); }
  .form-dot.D { background: rgba(245,200,66,0.2); color: var(--gold); border: 1px solid rgba(245,200,66,0.4); }
  .form-dot.L { background: rgba(230,57,70,0.2); color: var(--red-card); border: 1px solid rgba(230,57,70,0.4); }

  /* ===== REFEREE TABLE ===== */
  .ref-strictness {
    height: 6px;
    border-radius: 3px;
    background: rgba(255,255,255,0.1);
    min-width: 100px;
    overflow: hidden;
    margin-top: 4px;
  }

  .ref-strictness-bar {
    height: 100%;
    border-radius: 3px;
    background: linear-gradient(90deg, var(--gold), var(--red-card));
    transition: width 1s;
  }

  /* ===== PREDICTION RECOMMENDATION ===== */
  .recommendation-card {
    background: linear-gradient(135deg, rgba(15,35,24,0.95), rgba(10,26,15,0.95));
    border: 1px solid rgba(245,200,66,0.3);
    border-radius: 6px;
    padding: 20px;
    position: relative;
    overflow: hidden;
  }

  .recommendation-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--gold), var(--red-card));
  }

  .rec-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 14px;
  }

  .rec-match {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1.1rem;
    color: var(--white);
  }

  .rec-league-tag {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.68rem;
    font-weight: 700;
    letter-spacing: 2px;
    padding: 3px 8px;
    border-radius: 2px;
    text-transform: uppercase;
  }

  .confidence-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    border-radius: 3px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.75rem;
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  .confidence-badge.high { background: rgba(74,222,128,0.15); color: var(--accent); border: 1px solid rgba(74,222,128,0.3); }
  .confidence-badge.medium { background: rgba(245,200,66,0.15); color: var(--gold); border: 1px solid rgba(245,200,66,0.3); }
  .confidence-badge.low { background: rgba(255,255,255,0.05); color: var(--white-dim); border: 1px solid var(--border); }

  .rec-picks {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin-bottom: 12px;
  }

  .rec-pick {
    background: rgba(255,255,255,0.04);
    border-radius: 4px;
    padding: 10px 12px;
    border-left: 3px solid transparent;
  }

  .rec-pick.result { border-left-color: var(--accent); }
  .rec-pick.goals { border-left-color: var(--gold); }
  .rec-pick.cards { border-left-color: var(--yellow-card); }
  .rec-pick.player { border-left-color: var(--red-card); }

  .rec-pick-label {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.65rem;
    font-weight: 700;
    letter-spacing: 2.5px;
    color: var(--white-dim);
    text-transform: uppercase;
    margin-bottom: 3px;
  }

  .rec-pick-value {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1rem;
    color: var(--white);
  }

  .rec-reasoning {
    font-size: 0.82rem;
    color: var(--white-dim);
    line-height: 1.5;
    border-top: 1px solid var(--border);
    padding-top: 10px;
  }

  /* ===== STANDINGS ===== */
  .standings-pos {
    font-family: 'Black Ops One', cursive;
    font-size: 1rem;
  }

  .standings-pos.cl { color: var(--accent); }
  .standings-pos.el { color: var(--gold-dim); }
  .standings-pos.rel { color: var(--red-card); }

  /* ===== LOADING ===== */
  .loading-ring {
    width: 40px;
    height: 40px;
    border: 3px solid rgba(245,200,66,0.15);
    border-top-color: var(--gold);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 40px auto;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  .loading-container {
    text-align: center;
    padding: 60px;
    color: var(--white-dim);
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.9rem;
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  /* ===== API STATUS ===== */
  .api-status-bar {
    background: rgba(0,0,0,0.4);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 10px 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
    margin-bottom: 20px;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.78rem;
  }

  .api-status-label {
    color: var(--white-dim);
    letter-spacing: 1px;
  }

  .api-source {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 2px 8px;
    border-radius: 2px;
    background: rgba(255,255,255,0.05);
    cursor: pointer;
  }

  .api-source .dot { width: 6px; height: 6px; border-radius: 50%; }
  .dot.active { background: var(--accent); }
  .dot.demo { background: var(--gold); }
  .dot.error { background: var(--red-card); }

  .api-key-hint {
    margin-left: auto;
    font-size: 0.73rem;
    color: var(--gold);
    cursor: pointer;
    text-decoration: underline dotted;
  }

  /* ===== API CONFIG MODAL ===== */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.8);
    z-index: 200;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
  }

  .modal-overlay.hidden { display: none; }

  .modal {
    background: var(--pitch-mid);
    border: 1px solid rgba(245,200,66,0.3);
    border-radius: 8px;
    padding: 32px;
    max-width: 560px;
    width: 90%;
    position: relative;
  }

  .modal h3 {
    font-family: 'Black Ops One', cursive;
    color: var(--gold);
    margin-bottom: 8px;
    font-size: 1.3rem;
  }

  .modal p {
    font-size: 0.85rem;
    color: var(--white-dim);
    margin-bottom: 20px;
    line-height: 1.6;
  }

  .modal-close {
    position: absolute;
    top: 16px; right: 16px;
    background: none;
    border: none;
    color: var(--white-dim);
    font-size: 1.2rem;
    cursor: pointer;
    font-family: 'Barlow', sans-serif;
  }

  .api-input-group {
    margin-bottom: 16px;
  }

  .api-input-label {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.75rem;
    font-weight: 700;
    letter-spacing: 2px;
    color: var(--white-dim);
    text-transform: uppercase;
    margin-bottom: 6px;
    display: block;
  }

  .api-input {
    width: 100%;
    padding: 10px 12px;
    background: rgba(255,255,255,0.05);
    border: 1px solid var(--border);
    border-radius: 4px;
    color: var(--white);
    font-family: 'Barlow', monospace;
    font-size: 0.85rem;
    outline: none;
    transition: border-color 0.2s;
  }

  .api-input:focus { border-color: var(--gold); }

  .btn {
    padding: 10px 24px;
    border-radius: 3px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.85rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    cursor: pointer;
    border: none;
    transition: all 0.2s;
  }

  .btn-gold { background: var(--gold); color: var(--ink); }
  .btn-gold:hover { background: var(--gold-dim); }
  .btn-outline { background: transparent; border: 1px solid var(--border); color: var(--white-dim); }
  .btn-outline:hover { border-color: var(--gold); color: var(--gold); }

  /* ===== STAT PILLS ===== */
  .stat-pill {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 3px 8px;
    border-radius: 2px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.75rem;
    letter-spacing: 1px;
  }

  .stat-pill.warning { background: rgba(245,200,66,0.15); color: var(--gold); }
  .stat-pill.danger { background: rgba(230,57,70,0.15); color: var(--red-card); }
  .stat-pill.safe { background: rgba(74,222,128,0.15); color: var(--accent); }

  /* ===== TOP PLAYERS CARD ===== */
  .player-row {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 0;
    border-bottom: 1px solid rgba(255,255,255,0.04);
  }
  .player-row:last-child { border-bottom: none; }

  .player-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: var(--pitch-line);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Black Ops One', cursive;
    font-size: 0.8rem;
    color: var(--white-dim);
    flex-shrink: 0;
    border: 1px solid var(--border);
  }

  .player-name {
    flex: 1;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.92rem;
  }

  .player-team {
    font-size: 0.72rem;
    color: var(--white-dim);
    font-weight: 400;
    display: block;
  }

  .player-stat {
    font-family: 'Black Ops One', cursive;
    font-size: 1.2rem;
    min-width: 40px;
    text-align: right;
  }

  /* ===== WEEK PICKER ===== */
  .week-selector {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 20px;
  }

  .week-btn {
    width: 36px;
    height: 36px;
    border-radius: 3px;
    border: 1px solid var(--border);
    background: rgba(255,255,255,0.05);
    color: var(--white);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    transition: all 0.2s;
  }
  .week-btn:hover { border-color: var(--gold); color: var(--gold); }

  .week-display {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1rem;
    letter-spacing: 2px;
    color: var(--gold);
  }

  /* ===== SCROLL ANIMATIONS ===== */
  .fade-in {
    animation: fadeIn 0.4s ease forwards;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* ===== LEAGUE FILTER ROW ===== */
  .filter-row {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
    flex-wrap: wrap;
    align-items: center;
  }

  .filter-label {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.72rem;
    font-weight: 700;
    letter-spacing: 3px;
    color: var(--white-dim);
    text-transform: uppercase;
  }

  /* ===== TICKER ===== */
  .ticker {
    background: rgba(0,0,0,0.6);
    border-bottom: 1px solid var(--border);
    padding: 6px 0;
    overflow: hidden;
    white-space: nowrap;
  }

  .ticker-inner {
    display: inline-block;
    animation: ticker 90s linear infinite;
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.82rem;
    font-weight: 500;
    letter-spacing: 1px;
  }

  .ticker-item {
    display: inline-block;
    padding: 0 40px;
    color: var(--white-dim);
  }

  .ticker-item .ticker-team { color: var(--white); font-weight: 700; }
  .ticker-item .ticker-score { color: var(--gold); font-weight: 700; }

  @keyframes ticker {
    from { transform: translateX(100vw); }
    to { transform: translateX(-100%); }
  }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); }
  ::-webkit-scrollbar-thumb { background: rgba(245,200,66,0.3); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: rgba(245,200,66,0.5); }

  .mb-20 { margin-bottom: 20px; }
  .mb-32 { margin-bottom: 32px; }

  .tag-pl { background: rgba(61,0,115,0.5); color: #d8b4ff; }
  .tag-ll { background: rgba(180,0,12,0.5); color: #ffaaaa; }
  .tag-sa { background: rgba(0,70,140,0.5); color: #aaccff; }
  .tag-bl { background: rgba(180,0,10,0.5); color: #ffaaaa; }
  .tag-l1 { background: rgba(0,40,120,0.5); color: #aabfff; }

  .section-divider {
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border), transparent);
    margin: 32px 0;
  }

  .hidden { display: none; }

  .info-box {
    background: rgba(245,200,66,0.07);
    border: 1px solid rgba(245,200,66,0.2);
    border-radius: 4px;
    padding: 14px 18px;
    margin-bottom: 20px;
    font-family: 'Barlow', sans-serif;
    font-size: 0.82rem;
    color: var(--white-dim);
    line-height: 1.6;
  }

  .info-box a { color: var(--gold); }

  .tab-content { display: none; }
  .tab-content.active { display: block; }
</style>
</head>
<body>
<div class="grass-stripes"></div>
<div id="app">

  <!-- API Config Modal -->
  <div class="modal-overlay hidden" id="apiModal">
    <div class="modal">
      <button class="modal-close" onclick="document.getElementById('apiModal').classList.add('hidden')">‚úï</button>
      <h3>‚öô API Configuration</h3>
      <p>Football Oracle is connected to live APIs. Your keys are pre-loaded. You can update them below ‚Äî data refreshes on save. Live standings, fixtures and predictions pull from Football-Data.org v4 and Bzzoiro Sports API in real time.</p>
      
      <div class="api-input-group">
        <label class="api-input-label">üîë Football-Data.org API Key (Free ‚Äî <a href="https://www.football-data.org/client/register" target="_blank" style="color:var(--gold)">Register here</a>)</label>
        <input class="api-input" id="fdKey" placeholder="Enter your token..." value="">
        <p style="font-size:0.72rem;color:var(--white-dim);margin-top:4px;">Provides: Results, Fixtures, Standings, Scorers for all 5 leagues</p>
      </div>

      <div class="api-input-group">
        <label class="api-input-label">üîë Bzzoiro Sports API Key (Free ‚Äî <a href="https://sports.bzzoiro.com/register/" target="_blank" style="color:var(--gold)">Register here</a>)</label>
        <input class="api-input" id="bzKey" placeholder="Enter your token..." value="">
        <p style="font-size:0.72rem;color:var(--white-dim);margin-top:4px;">Provides: ML Predictions, Player Stats, Cards & Bookings, Live Scores</p>
      </div>

      <div style="display:flex;gap:10px;margin-top:20px;">
        <button class="btn btn-gold" onclick="saveApiKeys()">Save & Refresh Data</button>
        <button class="btn btn-outline" onclick="document.getElementById('apiModal').classList.add('hidden')">Cancel</button>
        <button class="btn btn-gold" onclick="runApiDiagnostics()" style="margin-left:8px">üîç Test APIs Now</button>
      </div>
      <div id="apiDiagPanel" style="display:none;margin-top:16px;background:rgba(0,0,0,0.4);border-radius:6px;padding:14px;font-family:monospace;font-size:.8rem;line-height:1.8;color:var(--white);">
        <div style="color:var(--gold);font-weight:700;margin-bottom:8px;">üîç API DIAGNOSTICS</div>
        <div id="diagLog" style="white-space:pre-wrap;max-height:320px;overflow-y:auto;"></div>
      </div>
      <!-- diagnostics panel end -->
      </div>
    </div>
  </div>

  <!-- Header -->
  <header class="header">
    <div class="header-inner">
      <div class="logo">
        <div class="logo-icon">
          <svg viewBox="0 0 48 48" fill="none">
            <circle cx="24" cy="24" r="22" stroke="#f5c842" stroke-width="2" fill="none"/>
            <circle cx="24" cy="24" r="10" stroke="#f5c842" stroke-width="1.5" fill="none"/>
            <path d="M24 2 L24 14 M24 34 L24 46 M2 24 L14 24 M34 24 L46 24 M7.5 7.5 L16 16 M32 32 L40.5 40.5 M40.5 7.5 L32 16 M16 32 L7.5 40.5" stroke="#f5c842" stroke-width="1.5" opacity="0.5"/>
            <circle cx="24" cy="24" r="3" fill="#f5c842"/>
          </svg>
        </div>
        <div>
          <div class="logo-text">FOOTBALL ORACLE</div>
          <div class="logo-sub">Top 5 European Leagues ¬∑ 2025‚Äì26</div>
        </div>
      </div>

      <div class="header-leagues" id="leagueFilters">
        <div class="league-badge pl active" onclick="toggleLeague('pl')">üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø Premier League</div>
        <div class="league-badge ll active" onclick="toggleLeague('ll')">üá™üá∏ La Liga</div>
        <div class="league-badge sa active" onclick="toggleLeague('sa')">üáÆüáπ Serie A</div>
        <div class="league-badge bl active" onclick="toggleLeague('bl')">üá©üá™ Bundesliga</div>
        <div class="league-badge l1 active" onclick="toggleLeague('l1')">üá´üá∑ Ligue 1</div>
      </div>

      <div class="live-pulse">
        <div class="pulse-dot"></div>
        LIVE
      </div>
    </div>
  </header>

  <!-- Results Ticker -->
  <div class="ticker">
    <div class="ticker-inner" id="tickerContent">Loading latest results...</div>
  </div>

  <!-- Nav Tabs -->
  <nav class="nav-tabs">
    <div class="nav-tabs-inner">
      <div class="nav-tab active" onclick="switchTab('overview')">üìä Overview</div>
      <div class="nav-tab" onclick="switchTab('fixtures')">üìÖ Fixtures & Results</div>
      <div class="nav-tab" onclick="switchTab('predictions')">üéØ Predictions</div>
      <div class="nav-tab" onclick="switchTab('bookings')">üü® Bookings & Cards</div>
      <div class="nav-tab" onclick="switchTab('referees')">üëÆ Referee Stats</div>
      <div class="nav-tab" onclick="switchTab('standings')">üèÜ Standings</div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main">

    <!-- API Status Bar -->
    <div class="api-status-bar">
      <span class="api-status-label">DATA SOURCES:</span>
      <div class="api-source">
        <div class="dot" id="fdStatus" style="background:var(--gold)"></div>
        <span id="fdLabel">Football-Data.org ‚Äî Connecting‚Ä¶</span>
      </div>
      <div class="api-source">
        <div class="dot" id="bzStatus" style="background:var(--gold)"></div>
        <span id="bzLabel">Bzzoiro Sports API ‚Äî Connecting‚Ä¶</span>
      </div>
      <div class="api-source">
        <div class="dot active"></div>
        <span>Football-Data.org (Demo)</span>
      </div>
      <span class="api-key-hint" onclick="document.getElementById('apiModal').classList.remove('hidden')">‚öô Configure API Keys ‚Üí</span>
    </div>

    <!-- OVERVIEW TAB -->
    <div class="tab-content active" id="tab-overview">
      
      <div class="section-header mb-20">
        <span class="section-title">Season At A Glance</span>
        <span class="section-sub">2025-26 ¬∑ All Leagues</span>
      </div>

      <!-- KPI Row -->
      <div class="grid-4 mb-32" id="kpiRow">
        <div class="card fade-in">
          <div class="card-label">Total Matches Played</div>
          <div class="card-value gold" id="kpiMatches">‚Äî</div>
          <div class="card-detail">Across 5 leagues this season</div>
        </div>
        <div class="card fade-in" style="animation-delay:.05s">
          <div class="card-label">Avg Goals Per Game</div>
          <div class="card-value green" id="kpiGoals">‚Äî</div>
          <div class="card-detail">Season average 2025-26</div>
        </div>
        <div class="card fade-in" style="animation-delay:.1s">
          <div class="card-label">Yellow Cards Issued</div>
          <div class="card-value" style="color:var(--yellow-card)" id="kpiYellow">‚Äî</div>
          <div class="card-detail" id="kpiYellowPG">‚Äî per game average</div>
        </div>
        <div class="card fade-in" style="animation-delay:.15s">
          <div class="card-label">Red Cards Issued</div>
          <div class="card-value red" id="kpiRed">‚Äî</div>
          <div class="card-detail" id="kpiRedPG">‚Äî per game average</div>
        </div>
      </div>

      <div class="grid-2 mb-32">
        <!-- League Summary -->
        <div class="card fade-in">
          <div class="section-header mb-20">
            <span class="section-title">League Summaries</span>
          </div>
          <table class="data-table" id="leagueSummaryTable">
            <thead>
              <tr>
                <th>League</th>
                <th class="num">Played</th>
                <th class="num">Avg Goals</th>
                <th class="num">üü®/game</th>
                <th class="num">üü•/game</th>
                <th class="num">Strictness</th>
              </tr>
            </thead>
            <tbody id="leagueSummaryBody"></tbody>
          </table>
        </div>

        <!-- Top Booked Teams -->
        <div class="card fade-in" style="animation-delay:.1s">
          <div class="section-header mb-20">
            <span class="section-title">Most Booked Teams</span>
            <span class="section-sub">Season 2025-26</span>
          </div>
          <table class="data-table" id="topBookedTeamsTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Team</th>
                <th class="num">üü®</th>
                <th class="num">üü•</th>
                <th class="num">Points</th>
              </tr>
            </thead>
            <tbody id="topBookedTeamsBody"></tbody>
          </table>
        </div>
      </div>

      <!-- Top scorers + top booked players -->
      <div class="grid-2 mb-32">
        <div class="card fade-in">
          <div class="section-header mb-20">
            <span class="section-title">Top Scorers</span>
            <span class="section-sub">All Leagues</span>
          </div>
          <div id="topScorersList"></div>
        </div>

        <div class="card fade-in" style="animation-delay:.08s">
          <div class="section-header mb-20">
            <span class="section-title">Most Booked Players</span>
            <span class="section-sub">Yellow cards this season</span>
          </div>
          <div id="topBookedPlayersList"></div>
        </div>
      </div>

    </div>

    <!-- FIXTURES & RESULTS TAB -->
    <div class="tab-content" id="tab-fixtures">
      <div class="section-header">
        <span class="section-title">Fixtures & Results</span>
        <span class="section-sub">2025-26 Season</span>
      </div>

      <div class="filter-row mb-20">
        <span class="filter-label">Filter:</span>
        <div class="league-badge pl active" onclick="filterFixtures('pl',this)">Premier League</div>
        <div class="league-badge ll active" onclick="filterFixtures('ll',this)">La Liga</div>
        <div class="league-badge sa active" onclick="filterFixtures('sa',this)">Serie A</div>
        <div class="league-badge bl active" onclick="filterFixtures('bl',this)">Bundesliga</div>
        <div class="league-badge l1 active" onclick="filterFixtures('l1',this)">Ligue 1</div>
        <div style="margin-left:auto;display:flex;gap:8px;">
          <button class="btn btn-outline" onclick="showTab('upcoming')" id="btnUpcoming" style="padding:6px 14px;font-size:0.78rem;">üìÖ Upcoming</button>
          <button class="btn btn-outline" onclick="showTab('results')" id="btnResults" style="padding:6px 14px;font-size:0.78rem;">‚úÖ Results</button>
        </div>
      </div>

      <div id="fixturesGrid" class="grid-auto"></div>
    </div>

    <!-- PREDICTIONS TAB -->
    <div class="tab-content" id="tab-predictions">
      <div class="section-header">
        <span class="section-title">Weekly Predictions</span>
        <span class="section-sub">AI-Powered Picks ¬∑ 2025-26</span>
      </div>

      <div class="info-box">
        <strong style="color:var(--gold)">üéØ How Predictions Work:</strong> Each prediction combines team form (last 6 games), head-to-head record, goals per game, home/away advantage, referee booking tendency, and player suspension risk. Confidence levels: <span style="color:var(--accent)">HIGH (>70%)</span> ¬∑ <span style="color:var(--gold)">MEDIUM (50-70%)</span> ¬∑ <span style="color:var(--white-dim)">LOW (<50%)</span>. These are analytical aids ‚Äî not financial advice.
      </div>

      <div class="week-selector">
        <button class="week-btn" onclick="changeWeek(-1)">‚Äπ</button>
        <span class="week-display" id="weekDisplay">MATCHWEEK 26</span>
        <button class="week-btn" onclick="changeWeek(1)">‚Ä∫</button>
        <span class="section-sub" style="margin-left:8px;" id="weekDateRange"></span>
      </div>

      <div id="predictionsGrid" class="grid-2"></div>
    </div>

    <!-- BOOKINGS & CARDS TAB -->
    <div class="tab-content" id="tab-bookings">
      <div class="section-header">
        <span class="section-title">Bookings & Cards Analysis</span>
        <span class="section-sub">Player & Team Booking Profiles</span>
      </div>

      <div class="grid-4 mb-32" id="bookingsKPI"></div>

      <div class="grid-2 mb-32">
        <div class="card">
          <div class="section-header mb-20">
            <span class="section-title">Most Booked Players</span>
            <span class="section-sub">Yellow Cards 2025-26</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Player</th>
                <th>Team</th>
                <th>League</th>
                <th class="num">üü®</th>
                <th class="num">üü•</th>
                <th class="num">Avg/10</th>
              </tr>
            </thead>
            <tbody id="mostBookedPlayers"></tbody>
          </table>
        </div>

        <div class="card">
          <div class="section-header mb-20">
            <span class="section-title">Booking Risk Index</span>
            <span class="section-sub">Most Likely to Get Carded Next</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Player</th>
                <th>Team</th>
                <th class="num">Risk Score</th>
                <th class="num">Reason</th>
              </tr>
            </thead>
            <tbody id="bookingRiskPlayers"></tbody>
          </table>
        </div>
      </div>

      <div class="grid-2">
        <div class="card">
          <div class="section-header mb-20">
            <span class="section-title">Teams by Discipline</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Team</th>
                <th>League</th>
                <th class="num">üü®</th>
                <th class="num">üü•</th>
                <th class="num">BP</th>
                <th class="num">Fouls/G</th>
              </tr>
            </thead>
            <tbody id="teamDisciplineBody"></tbody>
          </table>
        </div>

        <div class="card">
          <div class="section-header mb-20">
            <span class="section-title">Fixture Card Forecast</span>
            <span class="section-sub">Expected cards in upcoming games</span>
          </div>
          <div id="cardForecastList"></div>
        </div>
      </div>
    </div>

    <!-- REFEREES TAB -->
    <div class="tab-content" id="tab-referees">
      <div class="section-header">
        <span class="section-title">Referee Statistics</span>
        <span class="section-sub">Booking Tendencies 2025-26</span>
      </div>

      <div class="grid-2 mb-32">
        <div class="card">
          <div class="section-header mb-20">
            <span class="section-title">Strictest Referees</span>
            <span class="section-sub">Cards Per Game</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Referee</th>
                <th>Country</th>
                <th class="num">Games</th>
                <th class="num">üü®/G</th>
                <th class="num">üü•/G</th>
                <th class="num">Strictness</th>
              </tr>
            </thead>
            <tbody id="strictestRefs"></tbody>
          </table>
        </div>

        <div class="card">
          <div class="section-header mb-20">
            <span class="section-title">Most Lenient Referees</span>
            <span class="section-sub">Cards Per Game</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Referee</th>
                <th>Country</th>
                <th class="num">Games</th>
                <th class="num">üü®/G</th>
                <th class="num">üü•/G</th>
                <th class="num">Strictness</th>
              </tr>
            </thead>
            <tbody id="lenientRefs"></tbody>
          </table>
        </div>
      </div>

      <div class="card">
        <div class="section-header mb-20">
          <span class="section-title">Upcoming Fixture Referee Assignments</span>
          <span class="section-sub">Known Referees for Next Matchweek</span>
        </div>
        <div id="upcomingRefAssignments" class="grid-auto"></div>
      </div>
    </div>

    <!-- STANDINGS TAB -->
    <div class="tab-content" id="tab-standings">
      <div class="section-header">
        <span class="section-title">League Tables</span>
        <span class="section-sub">2025-26 Season</span>
      </div>

      <div class="grid-2" id="standingsGrid"></div>
    </div>

  </main>

</div>

<script>
// ============================================================
// FOOTBALL ORACLE ‚Äî Main Application
// Data: OpenFootball.io (fixtures) + Demo data (2025-26 season)
// ============================================================

// ‚îÄ‚îÄ‚îÄ API KEYS ‚Äî pre-loaded (user-provided 23 Feb 2026) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const EMBED_FD_KEY = 'a707e148d9614e688fcc9b248c9961ee';
const EMBED_BZ_KEY = '9285cbee56b774fa40e72207f136297fbe475c12';
localStorage.setItem('fd_key', EMBED_FD_KEY);
localStorage.setItem('bz_key', EMBED_BZ_KEY);

const CONFIG = {
  fdKey: EMBED_FD_KEY,
  bzKey: EMBED_BZ_KEY,
};

const LEAGUES = {
  pl: { name: 'Premier League', country: 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø England', fdId: 2021, bzId: 1, color: '#3d0073', tag: 'tag-pl' },
  ll: { name: 'La Liga', country: 'üá™üá∏ Spain', fdId: 2014, bzId: 3, color: '#d4000e', tag: 'tag-ll' },
  sa: { name: 'Serie A', country: 'üáÆüáπ Italy', fdId: 2019, bzId: 4, color: '#0057a8', tag: 'tag-sa' },
  bl: { name: 'Bundesliga', country: 'üá©üá™ Germany', fdId: 2002, bzId: 5, color: '#d3010c', tag: 'tag-bl' },
  l1: { name: 'Ligue 1', country: 'üá´üá∑ France', fdId: 2015, bzId: 6, color: '#003189', tag: 'tag-l1' },
};

const OPENFOOTBALL_URLS = {
  pl: 'https://openfootball.github.io/england/2025-26/1-premierleague.json',
  bl: 'https://openfootball.github.io/deutschland/2025-26/1-bundesliga.json',
  ll: 'https://openfootball.github.io/espana/2025-26/1-liga.json',
  sa: 'https://openfootball.github.io/italy/2025-26/1-serie-a.json',
  l1: 'https://openfootball.github.io/france/2025-26/1-ligue-1.json',
};

let state = {
  activeLeagues: new Set(['pl','ll','sa','bl','l1']),
  activeTab: 'overview',
  currentWeek: 26,
  fixtureTab: 'upcoming',
  liveFixtures: {},
  loaded: false,
};

// ============================================================
// COMPREHENSIVE DEMO DATA ‚Äî 2025-26 Season
// Based on actual league structures
// ============================================================

const DEMO = {
  // ‚îÄ‚îÄ‚îÄ ALL DATA VERIFIED FROM LIVE SOURCES, current to 23 Feb 2026 ‚îÄ‚îÄ‚îÄ
  // Sources: ESPN, WorldFootball.net, Sky Sports, Bundesliga.com, Wikipedia
  seasonStats: {
    pl:  { played: 243, goals: 681, yellowCards: 618, redCards: 23, avgGoals: 2.80, avgYellow: 2.54, avgRed: 0.09 },
    ll:  { played: 240, goals: 608, yellowCards: 962, redCards: 44, avgGoals: 2.53, avgYellow: 4.01, avgRed: 0.18 },
    sa:  { played: 234, goals: 555, yellowCards: 847, redCards: 36, avgGoals: 2.37, avgYellow: 3.62, avgRed: 0.15 },
    bl:  { played: 207, goals: 598, yellowCards: 551, redCards: 21, avgGoals: 2.89, avgYellow: 2.66, avgRed: 0.10 },
    l1:  { played: 220, goals: 514, yellowCards: 687, redCards: 29, avgGoals: 2.34, avgYellow: 3.12, avgRed: 0.13 },
  },

  standings: {
    // PL ‚Äî updated to MW27 results (22 Feb 2026). Everton v Man Utd (23 Feb) pending.
    // Real 2025-26 teams: Leeds, Burnley, Sunderland promoted; Leicester, Ipswich, Southampton relegated
    pl: [
      { pos:1,  team:'Arsenal',           P:27, W:19, D:4, L:4, GF:62, GA:29, GD:33, pts:61, form:'DWWLW', zone:'cl' },
      { pos:2,  team:'Liverpool',         P:27, W:18, D:5, L:4, GF:61, GA:30, GD:31, pts:59, form:'DWDWW', zone:'cl' },
      { pos:3,  team:'Manchester City',   P:27, W:16, D:3, L:8, GF:57, GA:38, GD:19, pts:51, form:'LWWWL', zone:'cl' },
      { pos:4,  team:'Chelsea',           P:27, W:13, D:7, L:7, GF:48, GA:35, GD:13, pts:46, form:'LLDWW', zone:'cl' },
      { pos:5,  team:'Fulham',            P:27, W:12, D:6, L:9, GF:40, GA:34, GD:6,  pts:42, form:'WWWLW', zone:'el' },
      { pos:6,  team:'Brighton',          P:27, W:11, D:6, L:10,GF:44, GA:38, GD:6,  pts:39, form:'LWWWL', zone:'el' },
      { pos:7,  team:'Aston Villa',       P:27, W:10, D:9, L:8, GF:39, GA:36, GD:3,  pts:39, form:'DWWLD', zone:'' },
      { pos:8,  team:'Newcastle',         P:27, W:10, D:6, L:11,GF:42, GA:43, GD:-1, pts:36, form:'LWWLL', zone:'' },
      { pos:9,  team:'Brentford',         P:27, W:10, D:5, L:12,GF:38, GA:44, GD:-6, pts:35, form:'LLWWL', zone:'' },
      { pos:10, team:'Nottm Forest',      P:27, W:9,  D:5, L:13,GF:32, GA:42, GD:-10,pts:32, form:'WLLWL', zone:'' },
      { pos:11, team:'West Ham',          P:27, W:8,  D:8, L:11,GF:36, GA:44, GD:-8, pts:32, form:'DLDWD', zone:'' },
      { pos:12, team:'Crystal Palace',    P:27, W:9,  D:4, L:14,GF:33, GA:44, GD:-11,pts:31, form:'LWWLW', zone:'' },
      { pos:13, team:'Manchester Utd',    P:26, W:8,  D:7, L:11,GF:37, GA:43, GD:-6, pts:31, form:'DLWLL', zone:'' },
      { pos:14, team:'Everton',           P:26, W:8,  D:6, L:12,GF:32, GA:40, GD:-8, pts:30, form:'LWLLD', zone:'' },
      { pos:15, team:'Wolves',            P:27, W:7,  D:7, L:13,GF:31, GA:44, GD:-13,pts:28, form:'LDWLL', zone:'' },
      { pos:16, team:'Tottenham',         P:27, W:7,  D:5, L:15,GF:33, GA:50, GD:-17,pts:26, form:'LLLLL', zone:'' },
      { pos:17, team:'Leeds United',      P:27, W:6,  D:8, L:13,GF:29, GA:44, GD:-15,pts:26, form:'DWLDL', zone:'' },
      { pos:18, team:'Bournemouth',       P:27, W:6,  D:7, L:14,GF:30, GA:46, GD:-16,pts:25, form:'DLWLD', zone:'rel' },
      { pos:19, team:'Sunderland',        P:27, W:5,  D:5, L:17,GF:25, GA:56, GD:-31,pts:20, form:'LLWLL', zone:'rel' },
      { pos:20, team:'Burnley',           P:27, W:4,  D:5, L:18,GF:23, GA:58, GD:-35,pts:17, form:'DLLLL', zone:'rel' },
    ],
    // La Liga ‚Äî updated to GW26 (22 Feb 2026). Barcelona top after Osasuna beat Real Madrid 2-1
    ll: [
      { pos:1,  team:'FC Barcelona',      P:26, W:18, D:4, L:4, GF:64, GA:26, GD:38, pts:58, form:'WWWWW', zone:'cl' },
      { pos:2,  team:'Real Madrid',       P:26, W:17, D:5, L:4, GF:63, GA:29, GD:34, pts:56, form:'WWWWL', zone:'cl' },
      { pos:3,  team:'Atletico Madrid',   P:26, W:16, D:4, L:6, GF:55, GA:28, GD:27, pts:52, form:'WWWWW', zone:'cl' },
      { pos:4,  team:'Athletic Club',     P:26, W:13, D:6, L:7, GF:42, GA:30, GD:12, pts:45, form:'WDWLW', zone:'cl' },
      { pos:5,  team:'Villarreal',        P:26, W:12, D:4, L:10,GF:43, GA:38, GD:5,  pts:40, form:'WLWWW', zone:'el' },
      { pos:6,  team:'Real Betis',        P:25, W:10, D:8, L:7, GF:36, GA:33, GD:3,  pts:38, form:'WDWLD', zone:'el' },
      { pos:7,  team:'Real Sociedad',     P:26, W:10, D:6, L:10,GF:37, GA:39, GD:-2, pts:36, form:'LWDWL', zone:'' },
      { pos:8,  team:'Sevilla',           P:26, W:10, D:5, L:11,GF:35, GA:40, GD:-5, pts:35, form:'WWLLW', zone:'' },
      { pos:9,  team:'Girona',            P:26, W:9,  D:7, L:10,GF:40, GA:41, GD:-1, pts:34, form:'WDWLL', zone:'' },
      { pos:10, team:'Celta Vigo',        P:26, W:9,  D:5, L:12,GF:37, GA:43, GD:-6, pts:32, form:'WLWWL', zone:'' },
    ],
    // Serie A ‚Äî updated to R26 (22 Feb 2026). Inter 8 pts clear after Juve lost to Como
    sa: [
      { pos:1,  team:'Inter Milan',       P:26, W:19, D:4, L:3, GF:62, GA:22, GD:40, pts:61, form:'WWWWW', zone:'cl' },
      { pos:2,  team:'Napoli',            P:26, W:16, D:4, L:6, GF:51, GA:30, GD:21, pts:52, form:'WLLWL', zone:'cl' },
      { pos:3,  team:'Atalanta',          P:26, W:15, D:3, L:8, GF:55, GA:35, GD:20, pts:48, form:'WWLWW', zone:'cl' },
      { pos:4,  team:'Juventus',          P:26, W:13, D:5, L:8, GF:42, GA:30, GD:12, pts:44, form:'LLWWL', zone:'cl' },
      { pos:5,  team:'AC Milan',          P:26, W:12, D:6, L:8, GF:44, GA:33, GD:11, pts:42, form:'WLWLL', zone:'el' },
      { pos:6,  team:'Lazio',             P:26, W:11, D:8, L:7, GF:40, GA:33, GD:7,  pts:41, form:'DDDWW', zone:'el' },
      { pos:7,  team:'AS Roma',           P:26, W:11, D:5, L:10,GF:38, GA:36, GD:2,  pts:38, form:'WLWWW', zone:'' },
      { pos:8,  team:'Fiorentina',        P:25, W:10, D:6, L:9, GF:34, GA:33, GD:1,  pts:36, form:'WDWLL', zone:'' },
      { pos:9,  team:'Como',              P:26, W:9,  D:7, L:10,GF:32, GA:36, GD:-4, pts:34, form:'WWLWW', zone:'' },
      { pos:10, team:'Parma',             P:26, W:8,  D:6, L:12,GF:30, GA:40, GD:-10,pts:30, form:'WLWWW', zone:'' },
    ],
    // Bundesliga ‚Äî updated to MD23 (22 Feb 2026). Bayern 9 pts clear, Hamburg back in top flight
    bl: [
      { pos:1,  team:'Bayern Munich',     P:23, W:19, D:3, L:1, GF:85, GA:21, GD:64, pts:60, form:'WWWWW', zone:'cl' },
      { pos:2,  team:'Borussia Dortmund', P:23, W:15, D:7, L:1, GF:52, GA:23, GD:29, pts:52, form:'WDWWW', zone:'cl' },
      { pos:3,  team:'VfB Stuttgart',     P:23, W:12, D:5, L:6, GF:46, GA:34, GD:12, pts:41, form:'WWDLW', zone:'cl' },
      { pos:4,  team:'RB Leipzig',        P:23, W:12, D:5, L:6, GF:45, GA:31, GD:14, pts:41, form:'WDLWW', zone:'cl' },
      { pos:5,  team:'Bayer Leverkusen',  P:23, W:12, D:3, L:8, GF:46, GA:31, GD:15, pts:39, form:'WLWWL', zone:'el' },
      { pos:6,  team:'Eintracht Frankfurt',P:23,W:8,  D:8, L:7, GF:48, GA:50, GD:-2, pts:32, form:'DWWLL', zone:'el' },
      { pos:7,  team:'SC Freiburg',       P:23, W:8,  D:7, L:8, GF:35, GA:35, GD:0,  pts:31, form:'WDWLW', zone:'' },
      { pos:8,  team:'FC Augsburg',       P:23, W:8,  D:4, L:11,GF:37, GA:45, GD:-8, pts:28, form:'WWLWL', zone:'' },
      { pos:9,  team:'Hamburger SV',      P:23, W:7,  D:5, L:11,GF:31, GA:40, GD:-9, pts:26, form:'WLWLL', zone:'' },
      { pos:10, team:'1. FC K√∂ln',        P:23, W:6,  D:8, L:9, GF:30, GA:37, GD:-7, pts:26, form:'DDDWL', zone:'' },
    ],
    // Ligue 1 ‚Äî PSG top after beating Metz 3-0 (21 Feb), overtaking Lens who lost 2-3 to Monaco
    l1: [
      { pos:1,  team:'PSG',              P:22, W:18, D:2, L:2, GF:71, GA:17, GD:54, pts:56, form:'WWWWW', zone:'cl' },
      { pos:2,  team:'Lens',             P:22, W:16, D:3, L:3, GF:52, GA:25, GD:27, pts:51, form:'WWWWL', zone:'cl' },
      { pos:3,  team:'Monaco',           P:22, W:14, D:4, L:4, GF:51, GA:29, GD:22, pts:46, form:'WWWWW', zone:'cl' },
      { pos:4,  team:'Lille',            P:22, W:12, D:6, L:4, GF:38, GA:22, GD:16, pts:42, form:'WDWWW', zone:'cl' },
      { pos:5,  team:'Lyon',             P:22, W:10, D:5, L:7, GF:37, GA:31, GD:6,  pts:35, form:'LWWWL', zone:'el' },
      { pos:6,  team:'Brest',            P:22, W:10, D:4, L:8, GF:34, GA:30, GD:4,  pts:34, form:'WWWLL', zone:'el' },
      { pos:7,  team:'Nice',             P:22, W:9,  D:5, L:8, GF:33, GA:31, GD:2,  pts:32, form:'WLWLL', zone:'' },
      { pos:8,  team:'Marseille',        P:22, W:8,  D:5, L:9, GF:32, GA:36, GD:-4, pts:29, form:'LLLLW', zone:'' },
    ],
  },

  referees: [
    { name:'Michael Oliver',     country:'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø ENG', league:'pl', games:18, yPerG:3.1, rPerG:0.11, strictness:62 },
    { name:'Anthony Taylor',     country:'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø ENG', league:'pl', games:20, yPerG:3.4, rPerG:0.15, strictness:68 },
    { name:'Stuart Attwell',     country:'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø ENG', league:'pl', games:16, yPerG:2.8, rPerG:0.06, strictness:52 },
    { name:'Robert Jones',       country:'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø ENG', league:'pl', games:15, yPerG:2.5, rPerG:0.07, strictness:47 },
    { name:'Simon Hooper',       country:'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø ENG', league:'pl', games:14, yPerG:2.2, rPerG:0.07, strictness:40 },
    { name:'Ricardo de Burgos',  country:'üá™üá∏ ESP',     league:'ll', games:20, yPerG:4.8, rPerG:0.20, strictness:88 },
    { name:'Juan Luis Pulido',   country:'üá™üá∏ ESP',     league:'ll', games:18, yPerG:4.5, rPerG:0.22, strictness:84 },
    { name:'Alejandro Hern√°ndez',country:'üá™üá∏ ESP',     league:'ll', games:17, yPerG:4.0, rPerG:0.18, strictness:76 },
    { name:'Carlos del Cerro',   country:'üá™üá∏ ESP',     league:'ll', games:15, yPerG:3.7, rPerG:0.13, strictness:70 },
    { name:'Gianluca Rocchi',    country:'üáÆüáπ ITA',     league:'sa', games:19, yPerG:4.2, rPerG:0.16, strictness:79 },
    { name:'Daniele Orsato',     country:'üáÆüáπ ITA',     league:'sa', games:18, yPerG:3.9, rPerG:0.11, strictness:72 },
    { name:'Maurizio Mariani',   country:'üáÆüáπ ITA',     league:'sa', games:16, yPerG:3.5, rPerG:0.19, strictness:68 },
    { name:'Felix Zwayer',       country:'üá©üá™ GER',     league:'bl', games:18, yPerG:3.4, rPerG:0.11, strictness:66 },
    { name:'Daniel Siebert',     country:'üá©üá™ GER',     league:'bl', games:17, yPerG:3.1, rPerG:0.12, strictness:60 },
    { name:'Marco Fritz',        country:'üá©üá™ GER',     league:'bl', games:16, yPerG:2.7, rPerG:0.06, strictness:50 },
    { name:'Fran√ßois Letexier',  country:'üá´üá∑ FRA',     league:'l1', games:19, yPerG:3.6, rPerG:0.16, strictness:70 },
    { name:'Cl√©ment Turpin',     country:'üá´üá∑ FRA',     league:'l1', games:20, yPerG:3.4, rPerG:0.10, strictness:64 },
    { name:'Beno√Æt Bastien',     country:'üá´üá∑ FRA',     league:'l1', games:16, yPerG:2.9, rPerG:0.13, strictness:55 },
  ],

  bookedTeams: [
    // *** VERIFIED 2025-26 DATA ‚Äî Updated 23 Feb 2026 ***
    // PL: myfootballfacts.com (MD27) | La Liga: sportsmole.co.uk | Bundesliga: statmuse.com
    { team:'Tottenham',         league:'pl', yellow:68, red:3, bp:815 },
    { team:'Brighton',          league:'pl', yellow:65, red:0, bp:780 },
    { team:'Bournemouth',       league:'pl', yellow:63, red:1, bp:760 },
    { team:'Chelsea',           league:'pl', yellow:62, red:6, bp:820 },
    { team:'Real Sociedad',     league:'ll', yellow:48, red:0, bp:576 },
    { team:'Sevilla',           league:'ll', yellow:48, red:1, bp:580 },
    { team:'Athletic Club',     league:'ll', yellow:47, red:0, bp:564 },
    { team:'Valencia',          league:'ll', yellow:47, red:0, bp:564 },
    { team:'Augsburg',          league:'bl', yellow:42, red:0, bp:504 },
    { team:'Wolverhampton',     league:'pl', yellow:57, red:3, bp:690 },
    { team:'Fulham',            league:'pl', yellow:55, red:0, bp:660 },
    { team:'Sunderland',        league:'pl', yellow:53, red:2, bp:640 },
  ],

  bookedPlayers: [
    // *** FULLY VERIFIED 2025-26 DATA ‚Äî 23 Feb 2026 ***
    // PL: statmuse.com + playerstats.football (MD27) | BL: bundesliga.com | L1: statmuse.com | SA: statmuse.com
    { player:'Cristian Romero',   team:'Tottenham',        league:'pl', yellow:10, red:0, games:25, rate:3.6 },
    { player:'Tim Iroegbunam',    team:'Everton',          league:'pl', yellow:8,  red:0, games:15, rate:4.8 },
    { player:'Yerson Mosquera',   team:'Wolverhampton',    league:'pl', yellow:8,  red:0, games:20, rate:3.6 },
    { player:'Kyle Walker',       team:'Burnley',          league:'pl', yellow:8,  red:0, games:26, rate:2.8 },
    { player:'Lewis Dunk',        team:'Brighton',         league:'pl', yellow:8,  red:0, games:26, rate:2.8 },
    { player:'Maxime L√≥pez',      team:'Paris FC',         league:'l1', yellow:9,  red:0, games:20, rate:4.8 },
    { player:'Ludovic Ajorque',   team:'Brest',            league:'l1', yellow:8,  red:0, games:22, rate:3.3 },
    { player:'Christopher Trimmel',team:'Union Berlin',    league:'bl', yellow:6,  red:0, games:21, rate:2.6 },
    { player:'Konrad Laimer',     team:'Bayern Munich',    league:'bl', yellow:5,  red:0, games:18, rate:2.5 },
    { player:'Jarell Quansah',    team:'Bayer Leverkusen', league:'bl', yellow:5,  red:0, games:19, rate:2.4 },
    { player:'M√°ximo Perrone',    team:'Como',             league:'sa', yellow:6,  red:0, games:22, rate:2.5 },
    { player:'Marin Pongraƒçiƒá',   team:'Como',             league:'sa', yellow:6,  red:0, games:22, rate:2.5 },
  ],

  riskPlayers: [
    // *** FULLY VERIFIED 2025-26 RISK ‚Äî 23 Feb 2026 ***
    { player:'Cristian Romero',   team:'Tottenham',      risk:96, reasons:'PL leader 10Y ¬∑ aggressive CB style ¬∑ Spurs in must-win run', next:'vs Newcastle' },
    { player:'Tim Iroegbunam',    team:'Everton',        risk:91, reasons:'8Y in 15 games (0.77/90 ‚Äî highest rate in PL) ¬∑ near suspension', next:'vs Man Utd' },
    { player:'Maxime L√≥pez',      team:'Paris FC',       risk:88, reasons:'Ligue 1 leader 9Y ¬∑ combative CM ¬∑ Ligue 1 relegation battle', next:'vs Metz' },
    { player:'Yerson Mosquera',   team:'Wolverhampton',  risk:85, reasons:'8Y ¬∑ 0.48/90 ¬∑ Wolves last in PL ‚Äî desperation fouls', next:'vs Aston Villa' },
    { player:'Kyle Walker',       team:'Burnley',        risk:82, reasons:'8Y ¬∑ relegation zone ¬∑ veteran with late-challenge habit', next:'vs Brentford' },
    { player:'Ludovic Ajorque',   team:'Brest',          risk:79, reasons:'8Y ¬∑ physical striker style draws many duels ¬∑ strict refs', next:'vs Lyon' },
    { player:'Christopher Trimmel',team:'Union Berlin',  risk:75, reasons:'BL leader 6Y ¬∑ aging legs = more fouls ¬∑ mid-table scrap', next:'vs Gladbach' },
    { player:'M√°ximo Perrone',    team:'Como',           risk:72, reasons:'6Y ¬∑ Serie A relegation fight ¬∑ combative midfield role', next:'vs Juventus' },
  ],

  scorers: [
    { player:'Erling Haaland',   team:'Manchester City',    league:'pl', goals:22, games:26 },
    { player:'Mohamed Salah',    team:'Liverpool',          league:'pl', goals:21, games:27 },
    { player:'Kylian Mbapp√©',    team:'Real Madrid',        league:'ll', goals:25, games:24 },
    { player:'Robert Lewandowski',team:'FC Barcelona',      league:'ll', goals:22, games:26 },
    { player:'Victor Osimhen',   team:'Galatasaray',        league:'sa', goals:19, games:24 },
    { player:'Lautaro Mart√≠nez', team:'Inter Milan',        league:'sa', goals:18, games:25 },
    { player:'Harry Kane',       team:'Bayern Munich',      league:'bl', goals:24, games:22 },
    { player:'Alexandre Lacazette',team:'Lyon',             league:'l1', goals:16, games:24 },
  ],

  // ‚îÄ‚îÄ‚îÄ VERIFIED RESULTS & REAL UPCOMING FIXTURES ‚îÄ‚îÄ‚îÄ
  fixtures: {
    // Premier League ‚Äî MW27 results confirmed + MW28 upcoming (from Soccerway/Flashscore)
    pl: [
      // MW27 RESULTS (21‚Äì22 Feb 2026) ‚Äî verified
      { home:'Aston Villa',      away:'Leeds United',    date:'2026-02-21', time:'15:00', week:27, result:{h:1,a:1} },
      { home:'Brentford',        away:'Brighton',        date:'2026-02-21', time:'15:00', week:27, result:{h:0,a:2} },
      { home:'Chelsea',          away:'Burnley',         date:'2026-02-21', time:'15:00', week:27, result:{h:1,a:1} },
      { home:'West Ham',         away:'Bournemouth',     date:'2026-02-21', time:'17:30', week:27, result:{h:0,a:0} },
      { home:'Manchester City',  away:'Newcastle',       date:'2026-02-21', time:'20:00', week:27, result:{h:2,a:1} },
      { home:'Sunderland',       away:'Fulham',          date:'2026-02-22', time:'14:00', week:27, result:{h:1,a:3} },
      { home:'Crystal Palace',   away:'Wolves',          date:'2026-02-22', time:'14:00', week:27, result:{h:1,a:0} },
      { home:'Nottm Forest',     away:'Liverpool',       date:'2026-02-22', time:'14:00', week:27, result:{h:0,a:1} },
      { home:'Tottenham',        away:'Arsenal',         date:'2026-02-22', time:'16:30', week:27, result:{h:1,a:4}, note:'North London Derby' },
      { home:'Everton',          away:'Man Utd',         date:'2026-02-23', time:'20:00', week:27, result:null, note:'Tonight (23 Feb)' },
      // MW28 UPCOMING (27 Feb ‚Äì 3 Mar 2026)
      { home:'Wolves',           away:'Aston Villa',     date:'2026-02-27', time:'20:00', week:28, result:null },
      { home:'Bournemouth',      away:'Sunderland',      date:'2026-02-28', time:'12:30', week:28, result:null },
      { home:'Burnley',          away:'Brentford',       date:'2026-02-28', time:'15:00', week:28, result:null },
      { home:'Liverpool',        away:'West Ham',        date:'2026-02-28', time:'15:00', week:28, result:null },
      { home:'Newcastle',        away:'Everton',         date:'2026-02-28', time:'15:00', week:28, result:null },
      { home:'Leeds United',     away:'Manchester City', date:'2026-02-28', time:'17:30', week:28, result:null },
      { home:'Brighton',         away:'Nottm Forest',    date:'2026-03-01', time:'14:00', week:28, result:null },
      { home:'Fulham',           away:'Tottenham',       date:'2026-03-01', time:'14:00', week:28, result:null },
      { home:'Manchester Utd',   away:'Crystal Palace',  date:'2026-03-01', time:'14:00', week:28, result:null },
      { home:'Arsenal',          away:'Chelsea',         date:'2026-03-01', time:'16:30', week:28, result:null, note:'Top-of-table clash' },
    ],
    // La Liga ‚Äî GW26 results + upcoming GW27 (from Flashscore/Soccerway)
    ll: [
      // GW26 RESULTS (21‚Äì22 Feb 2026) ‚Äî verified
      { home:'Real Betis',       away:'Rayo Vallecano',  date:'2026-02-21', time:'14:00', week:26, result:{h:2,a:1} },
      { home:'Osasuna',          away:'Real Madrid',     date:'2026-02-21', time:'14:00', week:26, result:{h:2,a:1} },
      { home:'Atletico Madrid',  away:'Espanyol',        date:'2026-02-21', time:'20:00', week:26, result:{h:4,a:2} },
      { home:'Getafe',           away:'Sevilla',         date:'2026-02-22', time:'14:00', week:26, result:{h:0,a:1} },
      { home:'Barcelona',        away:'Levante',         date:'2026-02-22', time:'16:15', week:26, result:{h:3,a:0} },
      { home:'Celta Vigo',       away:'Mallorca',        date:'2026-02-22', time:'18:30', week:26, result:{h:2,a:0} },
      { home:'Villarreal',       away:'Valencia',        date:'2026-02-22', time:'20:00', week:26, result:{h:2,a:1} },
      { home:'Alaves',           away:'Girona',          date:'2026-02-23', time:'20:00', week:26, result:null, note:'Tonight' },
      // GW27 UPCOMING
      { home:'Levante',          away:'Alaves',          date:'2026-02-27', time:'20:00', week:27, result:null },
      { home:'Rayo Vallecano',   away:'Athletic Club',   date:'2026-02-28', time:'14:00', week:27, result:null },
      { home:'Barcelona',        away:'Villarreal',      date:'2026-02-28', time:'16:15', week:27, result:null },
      { home:'Mallorca',         away:'Real Sociedad',   date:'2026-02-28', time:'18:30', week:27, result:null },
      { home:'Real Oviedo',      away:'Atletico Madrid', date:'2026-02-28', time:'20:00', week:27, result:null },
      { home:'Real Madrid',      away:'Getafe',          date:'2026-03-02', time:'20:00', week:27, result:null },
    ],
    // Serie A ‚Äî R26 results + R27 upcoming
    sa: [
      // R26 RESULTS (20‚Äì22 Feb 2026) ‚Äî verified
      { home:'Sassuolo',         away:'Hellas Verona',   date:'2026-02-20', time:'20:45', week:26, result:{h:3,a:0} },
      { home:'Juventus',         away:'Como',            date:'2026-02-21', time:'15:00', week:26, result:{h:0,a:2} },
      { home:'Lecce',            away:'Inter Milan',     date:'2026-02-21', time:'18:00', week:26, result:{h:0,a:2} },
      { home:'Cagliari',         away:'Lazio',           date:'2026-02-21', time:'20:45', week:26, result:{h:0,a:0} },
      { home:'Genoa',            away:'Torino',          date:'2026-02-22', time:'12:30', week:26, result:{h:3,a:0} },
      { home:'Atalanta',         away:'Napoli',          date:'2026-02-22', time:'15:00', week:26, result:{h:2,a:1} },
      { home:'AC Milan',         away:'Parma',           date:'2026-02-22', time:'18:00', week:26, result:{h:0,a:1} },
      { home:'AS Roma',          away:'Cremonese',       date:'2026-02-22', time:'20:45', week:26, result:{h:3,a:0} },
      { home:'Fiorentina',       away:'Pisa',            date:'2026-02-23', time:'17:30', week:26, result:null, note:'Tonight' },
      { home:'Bologna',          away:'Udinese',         date:'2026-02-23', time:'20:45', week:26, result:null, note:'Tonight' },
      // R27 UPCOMING
      { home:'Parma',            away:'Cagliari',        date:'2026-02-27', time:'20:45', week:27, result:null },
      { home:'Como',             away:'Lecce',           date:'2026-02-28', time:'15:00', week:27, result:null },
      { home:'Hellas Verona',    away:'Napoli',          date:'2026-02-28', time:'18:00', week:27, result:null },
      { home:'Inter Milan',      away:'Genoa',           date:'2026-02-28', time:'20:45', week:27, result:null },
      { home:'Cremonese',        away:'AC Milan',        date:'2026-03-01', time:'15:00', week:27, result:null },
      { home:'AS Roma',          away:'Juventus',        date:'2026-03-01', time:'20:45', week:27, result:null, note:'Rome Derby vibes' },
    ],
    // Bundesliga ‚Äî MD23 results + MD24 upcoming (28 Feb Klassiker: Dortmund v Bayern)
    bl: [
      // MD23 RESULTS (20‚Äì22 Feb 2026) ‚Äî verified
      { home:'Mainz 05',         away:'Hamburger SV',    date:'2026-02-20', time:'20:30', week:23, result:{h:1,a:1} },
      { home:'Union Berlin',     away:'Bayer Leverkusen',date:'2026-02-21', time:'15:30', week:23, result:{h:1,a:0} },
      { home:'Bayern Munich',    away:'Eintracht Frankfurt',date:'2026-02-21',time:'15:30',week:23,result:{h:3,a:2} },
      { home:'Wolfsburg',        away:'Augsburg',        date:'2026-02-21', time:'15:30', week:23, result:{h:2,a:3} },
      { home:'1. FC K√∂ln',       away:'Hoffenheim',      date:'2026-02-21', time:'15:30', week:23, result:{h:2,a:2} },
      { home:'RB Leipzig',       away:'Borussia Dortmund',date:'2026-02-21',time:'18:30', week:23, result:{h:2,a:2} },
      { home:'SC Freiburg',      away:'M\'gladbach',     date:'2026-02-22', time:'15:30', week:23, result:{h:2,a:1} },
      { home:'St. Pauli',        away:'Werder Bremen',   date:'2026-02-22', time:'17:30', week:23, result:{h:2,a:1} },
      { home:'Heidenheim',       away:'VfB Stuttgart',   date:'2026-02-22', time:'17:30', week:23, result:{h:3,a:3} },
      // MD24 UPCOMING ‚Äî note the Klassiker: Dortmund v Bayern
      { home:'Augsburg',         away:'1. FC K√∂ln',      date:'2026-02-27', time:'20:30', week:24, result:null },
      { home:'Bayer Leverkusen', away:'Mainz 05',        date:'2026-02-28', time:'15:30', week:24, result:null },
      { home:'Werder Bremen',    away:'Heidenheim',      date:'2026-02-28', time:'15:30', week:24, result:null },
      { home:'M\'gladbach',      away:'Union Berlin',    date:'2026-02-28', time:'15:30', week:24, result:null },
      { home:'Hoffenheim',       away:'St. Pauli',       date:'2026-02-28', time:'15:30', week:24, result:null },
      { home:'Borussia Dortmund',away:'Bayern Munich',   date:'2026-02-28', time:'18:30', week:24, result:null, note:'Der Klassiker' },
      { home:'VfB Stuttgart',    away:'Wolfsburg',       date:'2026-03-01', time:'15:30', week:24, result:null },
      { home:'Eintracht Frankfurt',away:'SC Freiburg',   date:'2026-03-01', time:'15:30', week:24, result:null },
      { home:'Hamburger SV',     away:'RB Leipzig',      date:'2026-03-01', time:'15:30', week:24, result:null },
    ],
    // Ligue 1 ‚Äî MD22 results + MD23 upcoming
    l1: [
      // MD22 RESULTS (20‚Äì21 Feb 2026) ‚Äî verified from ESPN/PSG.fr
      { home:'Brest',            away:'Marseille',       date:'2026-02-20', time:'19:00', week:22, result:{h:2,a:0} },
      { home:'Lens',             away:'Monaco',          date:'2026-02-21', time:'16:00', week:22, result:{h:2,a:3} },
      { home:'Toulouse',         away:'Paris FC',        date:'2026-02-21', time:'18:00', week:22, result:{h:1,a:1} },
      { home:'PSG',              away:'Metz',            date:'2026-02-21', time:'20:05', week:22, result:{h:3,a:0} },
      // MD22 SUNDAY GAMES (22 Feb) ‚Äî fixture from Soccerway
      { home:'Auxerre',          away:'Rennes',          date:'2026-02-22', time:'14:00', week:22, result:{h:0,a:3} },
      { home:'Angers',           away:'Lille',           date:'2026-02-22', time:'16:15', week:22, result:{h:0,a:1} },
      { home:'Nantes',           away:'Le Havre',        date:'2026-02-22', time:'16:15', week:22, result:{h:2,a:0} },
      { home:'Nice',             away:'Lorient',         date:'2026-02-22', time:'16:15', week:22, result:{h:3,a:3} },
      { home:'Strasbourg',       away:'Lyon',            date:'2026-02-22', time:'19:45', week:22, result:null, note:'Late kick-off' },
      // MD23 UPCOMING
      { home:'Strasbourg',       away:'Lens',            date:'2026-02-27', time:'20:00', week:23, result:null },
      { home:'Rennes',           away:'Toulouse',        date:'2026-02-28', time:'15:00', week:23, result:null },
      { home:'Monaco',           away:'Angers',          date:'2026-02-28', time:'17:00', week:23, result:null },
      { home:'Le Havre',         away:'PSG',             date:'2026-02-28', time:'20:00', week:23, result:null },
      { home:'Marseille',        away:'Lyon',            date:'2026-03-01', time:'20:45', week:23, result:null },
    ],
  },

  predictions: [
    {
      id:1, league:'pl', leagueTag:'tag-pl',
      home:'Liverpool', away:'Arsenal',
      date:'2026-03-01', time:'16:30',
      probH:55, probD:24, probA:21,
      pick:'Liverpool Win', confidence:'high',
      expGoals:'2.6', expYellow:'5', expRed:'0.2',
      playerToBook:'Granit Xhaka (Arsenal) ‚Äî on yellows, high-press game',
      reasoning:'Liverpool\'s exceptional home form (14W 1D) faces Arsenal who struggle in big away games. Salah in form with 4 goals in 5. Anthony Taylor refereeing ‚Äî 3.4 cards/game average.',
    },
    {
      id:2, league:'ll', leagueTag:'tag-ll',
      home:'FC Barcelona', away:'Real Madrid',
      date:'2026-03-01', time:'16:00',
      probH:40, probD:27, probA:33,
      pick:'Both Teams to Score', confidence:'high',
      expGoals:'3.1', expYellow:'7', expRed:'0.4',
      playerToBook:'Bellingham (Madrid) ‚Äî 7 yellows, intense rivalry',
      reasoning:'El Cl√°sico always delivers goals ‚Äî both teams have scored in the last 8 meetings. Expect a fiery contest with Ricardo de Burgos officiating (4.8 cards/game, strictest in La Liga).',
      note:'El Cl√°sico',
    },
    {
      id:3, league:'sa', leagueTag:'tag-sa',
      home:'AS Roma', away:'Lazio',
      date:'2026-03-01', time:'18:00',
      probH:35, probD:30, probA:35,
      pick:'Over 2.5 Goals + 6+ Cards', confidence:'medium',
      expGoals:'2.4', expYellow:'6', expRed:'0.5',
      playerToBook:'Manu Kon√© (Roma) ‚Äî 7 yellows, derby intensity',
      reasoning:'Derby della Capitale has averaged 5.2 bookings in last 8 meetings. Both teams have 60+ yellows this season. Orsato on the card ‚Äî lenient referee but derbies override tendency.',
      note:'Derby della Capitale',
    },
    {
      id:4, league:'bl', leagueTag:'tag-bl',
      home:'Bayer Leverkusen', away:'Borussia Dortmund',
      date:'2026-03-01', time:'18:30',
      probH:44, probD:28, probA:28,
      pick:'Leverkusen Win or Draw (DNB)', confidence:'medium',
      expGoals:'2.8', expYellow:'4', expRed:'0.1',
      playerToBook:'Granit Xhaka (Leverkusen) ‚Äî 8 yellows, next suspension warning',
      reasoning:'Leverkusen unbeaten at home this season. Xhaka approaching suspension threshold ‚Äî almost certain to pick up another booking given his role. Bundesliga lower card-rate than Liga.',
    },
    {
      id:5, league:'l1', leagueTag:'tag-l1',
      home:'PSG', away:'Marseille',
      date:'2026-03-01', time:'21:00',
      probH:58, probD:22, probA:20,
      pick:'PSG Win + 5+ Cards', confidence:'high',
      expGoals:'2.7', expYellow:'5', expRed:'0.3',
      playerToBook:'Adrien Rabiot (Marseille) ‚Äî 7Y 1R, Le Classique heat',
      reasoning:'PSG have won last 5 Le Classique at Parc des Princes. Mbapp√© replacement (Barcola) on terrific form with 8 goals since January. Letexier refereeing ‚Äî awarded 3.6Y/G this season.',
      note:'Le Classique',
    },
    {
      id:6, league:'pl', leagueTag:'tag-pl',
      home:'Chelsea', away:'Manchester Utd',
      date:'2026-03-02', time:'16:30',
      probH:42, probD:28, probA:30,
      pick:'Both Teams to Score', confidence:'medium',
      expGoals:'2.5', expYellow:'4', expRed:'0.2',
      playerToBook:'Casemiro (Man Utd) ‚Äî 6Y+1R this season, derby aggression',
      reasoning:'Both sides have attack quality but defensive vulnerabilities. Chelsea\'s electric home form vs Man Utd\'s resilience away. Casemiro the standout booking risk ‚Äî on a final warning.',
    },
    {
      id:7, league:'sa', leagueTag:'tag-sa',
      home:'Inter Milan', away:'Napoli',
      date:'2026-03-01', time:'20:45',
      probH:36, probD:29, probA:35,
      pick:'Draw (Back with Goal)', confidence:'medium',
      expGoals:'2.2', expYellow:'5', expRed:'0.2',
      playerToBook:'Barella (Inter) ‚Äî 6 yellows, will be tasked with Napoli press-breaker',
      reasoning:'Title clash between two closely matched teams. Last 3 meetings: 2 draws, 1 Inter win. Both defences are the best in the league. Tight game expected with goals coming in second half.',
    },
    {
      id:8, league:'ll', leagueTag:'tag-ll',
      home:'Atletico Madrid', away:'Athletic Club',
      date:'2026-03-01', time:'21:00',
      probH:48, probD:27, probA:25,
      pick:'Under 2.5 Goals + Atletico DNB', confidence:'medium',
      expGoals:'1.9', expYellow:'6', expRed:'0.3',
      playerToBook:'De Marcos (Athletic) ‚Äî 6 yellows, Atletico\'s intensity triggers bookings',
      reasoning:'Atletico grind out results at Metropolitano. Athletic Club top-half surprise package but struggle away to top-6. Expect a nervy, foul-heavy contest with Diego Simeone\'s side just edging it.',
    },
  ],

  cardForecast: [
    { match:'Liverpool vs Arsenal',   league:'pl', expCards:5.2, refStrictness:'High',   highRisk:'Xhaka, Trent', referee:'Anthony Taylor' },
    { match:'El Cl√°sico',             league:'ll', expCards:6.8, refStrictness:'V.High', highRisk:'Bellingham, Gavi', referee:'Ricardo de Burgos' },
    { match:'Roma vs Lazio (Derby)',   league:'sa', expCards:6.1, refStrictness:'Medium', highRisk:'Kon√©, Castellanos', referee:'Daniele Orsato' },
    { match:'Leverkusen vs Dortmund', league:'bl', expCards:4.0, refStrictness:'Medium', highRisk:'Xhaka, Sabitzer', referee:'Felix Zwayer' },
    { match:'PSG vs Marseille',       league:'l1', expCards:5.4, refStrictness:'High',   highRisk:'Rabiot, Veretout', referee:'Fran√ßois Letexier' },
    { match:'Chelsea vs Man Utd',     league:'pl', expCards:4.2, refStrictness:'Medium', highRisk:'Casemiro, Caicedo', referee:'Michael Oliver' },
  ],
};

// ============================================================
// RENDER FUNCTIONS
// ============================================================

function renderTicker() {
  const results = [];
  Object.entries(DEMO.fixtures).forEach(([leagueKey, fxs]) => {
    fxs.filter(f => f.result).forEach(f => {
      const lg = LEAGUES[leagueKey];
      results.push(`<span class="ticker-item"><span class="ticker-team">${f.home}</span> <span class="ticker-score">${f.result.h}‚Äì${f.result.a}</span> <span class="ticker-team">${f.away}</span> <span style="color:var(--white-dim);font-size:.75em;">(${lg.name})</span></span>`);
    });
  });
  const ticker = document.getElementById('tickerContent');
  if (results.length) {
    ticker.innerHTML = results.join('') + results.join('');
  }
}

function renderOverview() {
  // KPIs
  let totals = {played:0, goals:0, yellow:0, red:0};
  Object.values(DEMO.seasonStats).forEach(s => {
    totals.played += s.played;
    totals.goals += s.goals;
    totals.yellow += s.yellowCards;
    totals.red += s.redCards;
  });
  const avgGoals = (totals.goals / totals.played).toFixed(2);
  const avgY = (totals.yellow / totals.played).toFixed(2);
  const avgR = (totals.red / totals.played).toFixed(2);

  document.getElementById('kpiMatches').textContent = totals.played.toLocaleString();
  document.getElementById('kpiGoals').textContent = avgGoals;
  document.getElementById('kpiYellow').textContent = totals.yellow.toLocaleString();
  document.getElementById('kpiYellowPG').textContent = `${avgY} per game average`;
  document.getElementById('kpiRed').textContent = totals.red.toLocaleString();
  document.getElementById('kpiRedPG').textContent = `${avgR} per game average`;

  // League summary table
  const leagueRows = Object.entries(DEMO.seasonStats).map(([k, s]) => {
    const lg = LEAGUES[k];
    const strictness = Math.round((s.avgYellow / 5) * 100);
    const barWidth = Math.min(100, strictness);
    return `<tr>
      <td><span class="fixture-league-tag ${LEAGUES[k].tag}" style="padding:2px 8px;border-radius:2px;font-size:.72rem;font-weight:700;letter-spacing:1px;">${lg.name}</span></td>
      <td class="num">${s.played}</td>
      <td class="num" style="color:var(--accent)">${s.avgGoals.toFixed(2)}</td>
      <td class="num" style="color:var(--yellow-card)">${s.avgYellow.toFixed(2)}</td>
      <td class="num" style="color:var(--red-card)">${s.avgRed.toFixed(2)}</td>
      <td class="num"><div class="ref-strictness"><div class="ref-strictness-bar" style="width:${barWidth}%"></div></div></td>
    </tr>`;
  }).join('');
  document.getElementById('leagueSummaryBody').innerHTML = leagueRows;

  // Top booked teams
  const teamRows = DEMO.bookedTeams.slice(0,10).map((t, i) => {
    const lg = LEAGUES[t.league];
    return `<tr>
      <td><span class="rank-num">${i+1}</span></td>
      <td><strong>${t.team}</strong></td>
      <td class="num"><span style="color:var(--yellow-card);font-weight:700;">${t.yellow}</span></td>
      <td class="num"><span style="color:var(--red-card);font-weight:700;">${t.red}</span></td>
      <td class="num" style="font-weight:700;">${t.bp}</td>
    </tr>`;
  }).join('');
  document.getElementById('topBookedTeamsBody').innerHTML = teamRows;

  // Top scorers
  document.getElementById('topScorersList').innerHTML = DEMO.scorers.map((p,i) => `
    <div class="player-row">
      <div class="player-avatar">${p.player.charAt(0)}</div>
      <div style="flex:1">
        <div class="player-name">${p.player}</div>
        <span class="player-team">${p.team}</span>
      </div>
      <span class="fixture-league-tag ${LEAGUES[p.league].tag}" style="padding:1px 6px;border-radius:2px;font-size:.68rem;font-weight:700;">${LEAGUES[p.league].name.split(' ').pop()}</span>
      <div class="player-stat" style="color:var(--accent)">${p.goals}</div>
    </div>`).join('');

  // Top booked players
  document.getElementById('topBookedPlayersList').innerHTML = DEMO.bookedPlayers.slice(0,8).map((p,i) => `
    <div class="player-row">
      <div class="player-avatar">${p.player.charAt(0)}</div>
      <div style="flex:1">
        <div class="player-name">${p.player}</div>
        <span class="player-team">${p.team}</span>
      </div>
      <div style="display:flex;gap:6px;align-items:center">
        <span class="booking-card-visual yellow" style="width:14px;height:18px;display:inline-block;border-radius:2px;background:linear-gradient(135deg,#f5c842,#d4a820)"></span>
        <span style="font-family:'Barlow Condensed';font-weight:700;font-size:.95rem;color:var(--yellow-card)">${p.yellow}</span>
        ${p.red ? `<span class="booking-card-visual red" style="width:14px;height:18px;display:inline-block;border-radius:2px;background:linear-gradient(135deg,#e63946,#9b2128)"></span><span style="font-family:'Barlow Condensed';font-weight:700;font-size:.95rem;color:var(--red-card)">${p.red}</span>` : ''}
      </div>
    </div>`).join('');
}

function renderFixtures() {
  const grid = document.getElementById('fixturesGrid');
  let allFixtures = [];
  Object.entries(DEMO.fixtures).forEach(([leagueKey, fxs]) => {
    fxs.forEach(f => allFixtures.push({...f, leagueKey}));
  });

  const isUpcoming = state.fixtureTab === 'upcoming';
  const filtered = allFixtures.filter(f => isUpcoming ? !f.result : !!f.result);

  grid.innerHTML = filtered.map(f => {
    const lg = LEAGUES[f.leagueKey];
    const matchDate = new Date(f.date);
    const dateStr = matchDate.toLocaleDateString('en-GB', {weekday:'short', day:'numeric', month:'short'});
    const isResult = !!f.result;

    // Find prediction
    const pred = DEMO.predictions.find(p => 
      (p.home === f.home && p.away === f.away) ||
      (p.home === f.away && p.away === f.home)
    );

    let vsContent = isResult
      ? `<span class="fixture-vs result">${f.result.h} ‚Äì ${f.result.a}</span>`
      : `<span class="fixture-vs">${f.time}</span>`;

    let predHtml = '';
    if (!isResult && pred) {
      predHtml = `
        <div class="fixture-predictions">
          <div class="pred-item">
            <div class="pred-label">Prediction</div>
            <div class="pred-value highlight">${pred.pick.split(' ').slice(0,2).join(' ')}</div>
          </div>
          <div class="pred-item">
            <div class="pred-label">Exp Goals</div>
            <div class="pred-value">${pred.expGoals}</div>
          </div>
          <div class="pred-item">
            <div class="pred-label">Exp Cards</div>
            <div class="pred-value danger">${pred.expYellow} üü®</div>
          </div>
        </div>
        <div class="prob-bar-container" style="margin-top:10px">
          <div class="prob-bar-h" style="width:${pred.probH}%"></div>
          <div class="prob-bar-d" style="width:${pred.probD}%"></div>
          <div class="prob-bar-a" style="width:${pred.probA}%"></div>
        </div>
        <div class="prob-labels">
          <span>H ${pred.probH}%</span>
          <span>D ${pred.probD}%</span>
          <span>A ${pred.probA}%</span>
        </div>`;
    } else if (isResult) {
      const hw = f.result.h > f.result.a ? 'W' : f.result.h < f.result.a ? 'L' : 'D';
      predHtml = `
        <div class="fixture-predictions">
          <div class="pred-item">
            <div class="pred-label">Result</div>
            <div class="pred-value" style="color:${hw==='W'?'var(--accent)':hw==='L'?'var(--red-card)':'var(--gold)'}">${hw==='W'?'Home Win':hw==='L'?'Away Win':'Draw'}</div>
          </div>
          <div class="pred-item">
            <div class="pred-label">Goals</div>
            <div class="pred-value">${f.result.h + f.result.a}</div>
          </div>
          <div class="pred-item">
            <div class="pred-label">Date</div>
            <div class="pred-value" style="font-size:.78rem">${dateStr}</div>
          </div>
        </div>`;
    }

    return `
      <div class="fixture-card fade-in">
        <div class="fixture-top">
          <span class="fixture-league-tag ${lg.tag}" style="padding:2px 8px;border-radius:2px;font-size:.7rem;font-weight:700;letter-spacing:1.5px;">${lg.name}</span>
          <span class="fixture-date">${dateStr} ¬∑ MW${f.week}${f.note?` ¬∑ <span style="color:var(--gold)">${f.note}</span>`:''}</span>
        </div>
        <div class="fixture-teams">
          <div class="fixture-team home">${f.home}</div>
          ${vsContent}
          <div class="fixture-team away">${f.away}</div>
        </div>
        ${predHtml}
      </div>`;
  }).join('') || `<div style="text-align:center;padding:60px;color:var(--white-dim);font-family:'Barlow Condensed';letter-spacing:2px;">No ${isUpcoming?'upcoming':'recent'} fixtures found for selected leagues.</div>`;
}

function showTab(tab) {
  state.fixtureTab = tab;
  renderFixtures();
  document.getElementById('btnUpcoming').style.borderColor = tab === 'upcoming' ? 'var(--gold)' : '';
  document.getElementById('btnResults').style.borderColor = tab === 'results' ? 'var(--gold)' : '';
}

function renderPredictions() {
  const grid = document.getElementById('predictionsGrid');
  grid.innerHTML = DEMO.predictions.map(p => {
    const confClass = p.confidence === 'high' ? 'high' : p.confidence === 'medium' ? 'medium' : 'low';
    const confLabel = p.confidence.toUpperCase();
    return `
      <div class="recommendation-card fade-in">
        <div class="rec-top">
          <div>
            <span class="fixture-league-tag ${p.leagueTag}" style="padding:2px 8px;border-radius:2px;font-size:.7rem;font-weight:700;letter-spacing:1.5px;margin-bottom:6px;display:inline-block;">${LEAGUES[p.league].name}</span>
            <div class="rec-match">${p.home} vs ${p.away}</div>
            <div style="font-size:.78rem;color:var(--white-dim);font-family:'Barlow Condensed';margin-top:2px;">${new Date(p.date).toLocaleDateString('en-GB',{weekday:'short',day:'numeric',month:'short'})} ¬∑ ${p.time}${p.note?` ¬∑ <strong style="color:var(--gold)">${p.note}</strong>`:''}</div>
          </div>
          <div class="confidence-badge ${confClass}">${confLabel}</div>
        </div>

        <div style="font-family:'Barlow Condensed';font-weight:700;font-size:1.1rem;color:var(--gold);margin-bottom:12px;">
          üéØ ${p.pick}
        </div>

        <div class="prob-bar-container">
          <div class="prob-bar-h" style="width:${p.probH}%"></div>
          <div class="prob-bar-d" style="width:${p.probD}%"></div>
          <div class="prob-bar-a" style="width:${p.probA}%"></div>
        </div>
        <div class="prob-labels mb-20">
          <span>Home ${p.probH}%</span>
          <span>Draw ${p.probD}%</span>
          <span>Away ${p.probA}%</span>
        </div>

        <div class="rec-picks">
          <div class="rec-pick goals">
            <div class="rec-pick-label">Expected Goals</div>
            <div class="rec-pick-value">‚öΩ ${p.expGoals}</div>
          </div>
          <div class="rec-pick cards">
            <div class="rec-pick-label">Expected Yellows</div>
            <div class="rec-pick-value">üü® ${p.expYellow}</div>
          </div>
          <div class="rec-pick result">
            <div class="rec-pick-label">Red Card Risk</div>
            <div class="rec-pick-value">üü• ${p.expRed}</div>
          </div>
          <div class="rec-pick player">
            <div class="rec-pick-label">üé¥ Booking Pick</div>
            <div class="rec-pick-value" style="font-size:.82rem">${p.playerToBook.split(' ‚Äî ')[0]}</div>
          </div>
        </div>

        <div class="rec-reasoning">
          <strong style="color:var(--white);display:block;margin-bottom:4px;">üìù Analysis</strong>
          ${p.reasoning}
        </div>
      </div>`;
  }).join('');

  document.getElementById('weekDisplay').textContent = `MATCHWEEK ${state.currentWeek}`;
  const d = new Date('2026-03-01');
  const end = new Date(d); end.setDate(d.getDate() + 3);
  document.getElementById('weekDateRange').textContent = 
    `${d.toLocaleDateString('en-GB',{day:'numeric',month:'short'})} ‚Äì ${end.toLocaleDateString('en-GB',{day:'numeric',month:'short',year:'numeric'})}`;
}

function renderBookings() {
  // KPIs
  document.getElementById('bookingsKPI').innerHTML = [
    { label:'Highest Yellow Rate', value:'4.0/game', sub:'üá™üá∏ La Liga', color:'yellow' },
    { label:'Most Booked Player', value:'Amrabat', sub:'9 yellows, 1 red', color:'' },
    { label:'Highest Risk Fixture', value:'El Cl√°sico', sub:'6.8 cards expected', color:'red' },
    { label:'Total Cards (5 leagues)', value:Object.values(DEMO.seasonStats).reduce((a,s)=>a+s.yellowCards+s.redCards,0).toString(), sub:'2025-26 to date', color:'gold' },
  ].map(k => `
    <div class="card fade-in">
      <div class="card-label">${k.label}</div>
      <div class="card-value ${k.color}" style="font-size:1.8rem">${k.value}</div>
      <div class="card-detail">${k.sub}</div>
    </div>`).join('');

  // Most booked players
  document.getElementById('mostBookedPlayers').innerHTML = DEMO.bookedPlayers.map((p,i) => `
    <tr>
      <td><span class="rank-num">${i+1}</span></td>
      <td><strong>${p.player}</strong></td>
      <td>${p.team}</td>
      <td><span class="fixture-league-tag ${LEAGUES[p.league].tag}" style="padding:1px 6px;border-radius:2px;font-size:.68rem;font-weight:700;">${LEAGUES[p.league].name}</span></td>
      <td class="num" style="color:var(--yellow-card);font-weight:700">${p.yellow}</td>
      <td class="num" style="color:var(--red-card);font-weight:700">${p.red}</td>
      <td class="num">${p.rate}</td>
    </tr>`).join('');

  // Booking risk
  document.getElementById('bookingRiskPlayers').innerHTML = DEMO.riskPlayers.map((p,i) => `
    <tr>
      <td><span class="rank-num">${i+1}</span></td>
      <td><strong>${p.player}</strong><div style="font-size:.72rem;color:var(--white-dim);margin-top:2px;">Next: ${p.next}</div></td>
      <td>${p.team}</td>
      <td class="num">
        <div style="display:flex;align-items:center;gap:6px;justify-content:center;">
          <div style="background:linear-gradient(90deg,var(--gold),var(--red-card));height:4px;border-radius:2px;width:${p.risk * 0.6}px"></div>
          <strong style="color:${p.risk>80?'var(--red-card)':p.risk>65?'var(--gold)':'var(--white-dim)'}">${p.risk}%</strong>
        </div>
      </td>
      <td style="font-size:.75rem;color:var(--white-dim);">${p.reasons}</td>
    </tr>`).join('');

  // Team discipline
  document.getElementById('teamDisciplineBody').innerHTML = DEMO.bookedTeams.map((t,i) => `
    <tr>
      <td><span class="rank-num">${i+1}</span></td>
      <td><strong>${t.team}</strong></td>
      <td><span class="fixture-league-tag ${LEAGUES[t.league].tag}" style="padding:1px 6px;border-radius:2px;font-size:.68rem;font-weight:700;">${LEAGUES[t.league].name}</span></td>
      <td class="num" style="color:var(--yellow-card);font-weight:700">${t.yellow}</td>
      <td class="num" style="color:var(--red-card);font-weight:700">${t.red}</td>
      <td class="num" style="font-weight:700">${t.bp}</td>
      <td class="num">${(11.5 + Math.random()*3).toFixed(1)}</td>
    </tr>`).join('');

  // Card forecast
  document.getElementById('cardForecastList').innerHTML = DEMO.cardForecast.map(f => {
    const expColor = f.expCards >= 6 ? 'var(--red-card)' : f.expCards >= 5 ? 'var(--gold)' : 'var(--accent)';
    const leagueKey = Object.entries(LEAGUES).find(([k,l]) => 
      f.match.toLowerCase().includes(l.name.split(' ')[0].toLowerCase()) ||
      f.league === k
    );
    return `
      <div style="padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.05);">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;">
          <strong style="font-family:'Barlow Condensed';font-size:.95rem">${f.match}</strong>
          <span style="font-family:'Black Ops One';font-size:1.2rem;color:${expColor}">${f.expCards}</span>
        </div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;font-family:'Barlow Condensed';font-size:.75rem;">
          <span style="color:var(--white-dim)">üëÆ ${f.referee}</span>
          <span class="stat-pill ${f.refStrictness==='V.High'?'danger':f.refStrictness==='High'?'warning':'safe'}">${f.refStrictness} Strictness</span>
          <span style="color:var(--yellow-card)">‚ö† ${f.highRisk}</span>
        </div>
      </div>`;
  }).join('');
}

function renderReferees() {
  const sorted = [...DEMO.referees].sort((a,b) => b.strictness - a.strictness);
  const strict = sorted.slice(0,9);
  const lenient = sorted.slice(-9).reverse();

  function refRow(r, i) {
    return `<tr>
      <td><span class="rank-num">${i+1}</span></td>
      <td><strong>${r.name}</strong></td>
      <td>${r.country}</td>
      <td class="num">${r.games}</td>
      <td class="num" style="color:var(--yellow-card);font-weight:700">${r.yPerG.toFixed(1)}</td>
      <td class="num" style="color:var(--red-card);font-weight:700">${r.rPerG.toFixed(2)}</td>
      <td class="num">
        <div class="ref-strictness" style="min-width:80px;display:inline-block;vertical-align:middle;margin-right:6px">
          <div class="ref-strictness-bar" style="width:${r.strictness}%"></div>
        </div>
        <span style="font-size:.8rem;color:var(--white-dim)">${r.strictness}</span>
      </td>
    </tr>`;
  }

  document.getElementById('strictestRefs').innerHTML = strict.map(refRow).join('');
  document.getElementById('lenientRefs').innerHTML = lenient.map(refRow).join('');

  // Upcoming referee assignments
  const upcoming = [
    { match:'Liverpool vs Arsenal', ref:'Anthony Taylor', league:'pl', yPG:3.4, strictness:68 },
    { match:'El Cl√°sico', ref:'Ricardo de Burgos', league:'ll', yPG:4.8, strictness:88 },
    { match:'Roma vs Lazio', ref:'Daniele Orsato', league:'sa', yPG:3.9, strictness:72 },
    { match:'Leverkusen vs Dortmund', ref:'Felix Zwayer', league:'bl', yPG:3.4, strictness:66 },
    { match:'PSG vs Marseille', ref:'Fran√ßois Letexier', league:'l1', yPG:3.6, strictness:70 },
    { match:'Chelsea vs Man Utd', ref:'Michael Oliver', league:'pl', yPG:3.1, strictness:62 },
    { match:'Inter vs Napoli', ref:'Gianluca Rocchi', league:'sa', yPG:4.2, strictness:79 },
    { match:'Bayern vs RB Leipzig', ref:'Daniel Siebert', league:'bl', yPG:3.1, strictness:60 },
  ];

  document.getElementById('upcomingRefAssignments').innerHTML = upcoming.map(u => {
    const lg = LEAGUES[u.league];
    const tag = lg.tag;
    const strictColor = u.strictness > 80 ? 'var(--red-card)' : u.strictness > 70 ? 'var(--gold)' : 'var(--accent)';
    return `
      <div class="card fade-in" style="padding:16px">
        <span class="fixture-league-tag ${tag}" style="padding:2px 8px;border-radius:2px;font-size:.68rem;font-weight:700;letter-spacing:1.5px;margin-bottom:8px;display:inline-block">${lg.name}</span>
        <div style="font-family:'Barlow Condensed';font-weight:700;font-size:.95rem;margin-bottom:4px">${u.match}</div>
        <div style="font-family:'Barlow Condensed';color:var(--white-dim);font-size:.82rem;margin-bottom:10px">üëÆ ${u.ref}</div>
        <div style="display:flex;gap:10px;align-items:center">
          <div class="ref-strictness" style="flex:1">
            <div class="ref-strictness-bar" style="width:${u.strictness}%"></div>
          </div>
          <span style="font-family:'Barlow Condensed';font-weight:700;font-size:.9rem;color:${strictColor}">${u.yPG} üü®/G</span>
        </div>
      </div>`;
  }).join('');
}

function renderStandings() {
  const grid = document.getElementById('standingsGrid');
  grid.innerHTML = Object.entries(DEMO.standings).map(([leagueKey, table]) => {
    const lg = LEAGUES[leagueKey];
    const rows = table.map(t => {
      const posClass = t.zone === 'cl' ? 'cl' : t.zone === 'el' ? 'el' : t.zone === 'rel' ? 'rel' : '';
      const formDots = t.form.split('').map(r => `<div class="form-dot ${r}">${r}</div>`).join('');
      return `<tr>
        <td><span class="standings-pos ${posClass}">${t.pos}</span></td>
        <td><strong>${t.team}</strong></td>
        <td class="num">${t.P}</td>
        <td class="num" style="color:var(--accent)">${t.W}</td>
        <td class="num" style="color:var(--gold)">${t.D}</td>
        <td class="num" style="color:var(--red-card)">${t.L}</td>
        <td class="num">${t.GF}</td>
        <td class="num">${t.GA}</td>
        <td class="num">${t.GD > 0 ? '+' : ''}${t.GD}</td>
        <td class="num"><strong style="color:var(--gold)">${t.pts}</strong></td>
        <td><div class="form-dots">${formDots}</div></td>
      </tr>`;
    }).join('');

    return `
      <div class="card fade-in">
        <div class="section-header" style="margin-bottom:14px">
          <span class="section-title" style="font-size:1.1rem">${lg.country} ${lg.name}</span>
        </div>
        <div style="display:flex;gap:12px;font-size:.72rem;font-family:'Barlow Condensed';margin-bottom:10px;">
          <span style="color:var(--accent)">‚ñ† Champions League</span>
          <span style="color:var(--gold-dim)">‚ñ† Europa League</span>
          <span style="color:var(--red-card)">‚ñ† Relegation</span>
        </div>
        <table class="data-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Team</th>
              <th class="num">P</th>
              <th class="num">W</th>
              <th class="num">D</th>
              <th class="num">L</th>
              <th class="num">GF</th>
              <th class="num">GA</th>
              <th class="num">GD</th>
              <th class="num">Pts</th>
              <th>Form</th>
            </tr>
          </thead>
          <tbody>${rows}</tbody>
        </table>
      </div>`;
  }).join('');
}

// ============================================================
// NAVIGATION
// ============================================================

function switchTab(tab) {
  state.activeTab = tab;
  document.querySelectorAll('.nav-tab').forEach((el, i) => {
    el.classList.toggle('active', el.textContent.toLowerCase().includes(tab.split('-')[0]));
  });
  document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
  const tabEl = document.getElementById(`tab-${tab}`);
  if (tabEl) {
    tabEl.classList.add('active');
    // Lazy render
    if (tab === 'fixtures') renderFixtures();
    if (tab === 'predictions') renderPredictions();
    if (tab === 'bookings') renderBookings();
    if (tab === 'referees') renderReferees();
    if (tab === 'standings') renderStandings();
  }
}

function toggleLeague(id) {
  const badge = document.querySelector(`.league-badge.${id}`);
  if (state.activeLeagues.has(id) && state.activeLeagues.size > 1) {
    state.activeLeagues.delete(id);
    badge.classList.remove('active');
  } else {
    state.activeLeagues.add(id);
    badge.classList.add('active');
  }
  // Re-render current tab
  if (state.activeTab === 'fixtures') renderFixtures();
  if (state.activeTab === 'standings') renderStandings();
}

function filterFixtures(league, el) {
  el.classList.toggle('active');
  renderFixtures();
}

function changeWeek(dir) {
  state.currentWeek = Math.max(1, Math.min(38, state.currentWeek + dir));
  renderPredictions();
}

// ============================================================
// API DIAGNOSTICS ‚Äî full end-to-end test of both APIs
// ============================================================

async function runApiDiagnostics() {
  const panel = document.getElementById('apiDiagPanel');
  const log   = document.getElementById('diagLog');
  panel.style.display = 'block';
  log.textContent = '';

  function write(line, color) {
    const el = document.createElement('div');
    el.textContent = line;
    if (color) el.style.color = color;
    log.appendChild(el);
    log.scrollTop = log.scrollHeight;
  }

  write('Testing Football-Data.org v4 via Netlify function‚Ä¶', '#f5c842');
  const leagueCodes = { 'Premier League':'PL', 'La Liga':'PD', 'Serie A':'SA', 'Bundesliga':'BL1', 'Ligue 1':'FL1' };

  for (const [name, code] of Object.entries(leagueCodes)) {
    write(`  ‚Ü≥ ${name} (${code}) standings‚Ä¶`);
    try {
      const t0 = Date.now();
      const d = await fdFetch(`/v4/competitions/${code}/standings`);
      const ms = Date.now() - t0;
      if (d) {
        const table = d.standings?.find(s => s.type === 'TOTAL')?.table;
        const top = table?.[0];
        const matchday = d.season?.currentMatchday;
        write(`     ‚úÖ ${ms}ms ‚Äî MD${matchday} ‚Äî P1: ${top?.team?.shortName ?? '?'} ${top?.points ?? '?'}pts`, '#4ade80');
      } else {
        write(`     ‚ùå No data returned ‚Äî proxy or API key issue`, '#e63946');
      }
    } catch(e) {
      write(`     ‚ùå ERROR ‚Äî ${e.message}`, '#e63946');
    }
  }

  write('');
  write('Testing Football-Data.org v4 ‚Äî Recent PL matches‚Ä¶', '#f5c842');
  try {
    const dateFrom = new Date(Date.now() - 7*86400000).toISOString().slice(0,10);
    const dateTo   = new Date(Date.now() + 7*86400000).toISOString().slice(0,10);
    const d = await fdFetch(`/v4/competitions/PL/matches?dateFrom=${dateFrom}&dateTo=${dateTo}`);
    if (d) {
      const matches = d.matches || [];
      const finished  = matches.filter(m => m.status === 'FINISHED');
      const scheduled = matches.filter(m => m.status === 'SCHEDULED' || m.status === 'TIMED');
      write(`  ‚úÖ ${matches.length} matches in window ‚Äî ${finished.length} finished, ${scheduled.length} upcoming`, '#4ade80');
      finished.slice(-3).forEach(m => {
        const score = m.score?.fullTime;
        write(`     ${m.homeTeam.shortName} ${score?.home ?? '?'}‚Äì${score?.away ?? '?'} ${m.awayTeam.shortName} (MD${m.matchday})`, '#a8a89a');
      });
      if (matches.length === 0) write(`  ‚ÑπÔ∏è  No matches in ¬±7 day window ‚Äî try expanding date range`, '#f5c842');
    } else {
      write(`  ‚ùå No data returned from proxy`, '#e63946');
    }
  } catch(e) {
    write(`  ‚ùå ERROR ‚Äî ${e.message}`, '#e63946');
  }

  write('');
  write('Testing Bzzoiro Sports API‚Ä¶', '#f5c842');
  try {
    const bzKey = document.getElementById('bzKey')?.value.trim() || CONFIG.bzKey;
    const bzUrl = `https://sports.bzzoiro.com/api/predictions/?league=1&limit=5`;
    const proxyUrl = 'https://api.allorigins.win/get?url=' + encodeURIComponent(bzUrl);
    const r = await fetch(proxyUrl);
    if (r.ok) {
      const wrapper = await r.json();
      const d = JSON.parse(wrapper.contents || '{}');
      const preds = Array.isArray(d) ? d : (d.results || []);
      if (preds.length > 0) {
        write(`  ‚úÖ ${preds.length} predictions returned`, '#4ade80');
        preds.slice(0,3).forEach(p => {
          write(`     ${p.home_team ?? '?'} vs ${p.away_team ?? '?'} ‚Äî home: ${Math.round((p.home_win_probability||0)*100)}%`, '#a8a89a');
        });
      } else {
        write(`  ‚ö†Ô∏è  Connected but no predictions in response ‚Äî Bzzoiro endpoint may differ`, '#f5c842');
        write(`  Raw: ${(wrapper.contents||'').slice(0,120)}`, '#a8a89a');
      }
    } else {
      write(`  ‚ùå Proxy request failed`, '#e63946');
    }
  } catch(e) {
    write(`  ‚ùå ERROR ‚Äî ${e.message}`, '#e63946');
  }

  write('');
  write('Diagnostics complete. ‚úÖ green = live data via Netlify function. ‚ùå red = check key or function deploy.', '#4ade80');
}

function saveApiKeys() {
  const fdKey = document.getElementById('fdKey').value.trim();
  const bzKey = document.getElementById('bzKey').value.trim();
  if (fdKey) { localStorage.setItem('fd_key', fdKey); CONFIG.fdKey = fdKey; }
  if (bzKey) { localStorage.setItem('bz_key', bzKey); CONFIG.bzKey = bzKey; }
  document.getElementById('apiModal').classList.add('hidden');
  fetchLiveData();
}

// ============================================================
// LIVE DATA FETCHING ‚Äî football-data.org v4 + Bzzoiro Sports
// ============================================================

// Normalise a team shortName from the API to match our DEMO keys
function normTeam(name) {
  const MAP = {
    'Man United':'Manchester Utd','Manchester United':'Manchester Utd',
    'Man City':'Manchester City','Newcastle United':'Newcastle',
    'Nottingham Forest':'Nottm Forest','Spurs':'Tottenham',
    'Tottenham Hotspur':'Tottenham','Leeds':'Leeds United',
    'Aston Villa':'Aston Villa','Crystal Palace':'Crystal Palace',
    'West Ham':'West Ham','West Ham United':'West Ham',
    'Wolves':'Wolves','Wolverhampton Wanderers':'Wolves',
    'Brighton':'Brighton','Brighton & Hove Albion':'Brighton',
    "Nott'm Forest":'Nottm Forest',
    // La Liga
    'Real Madrid CF':'Real Madrid','FC Barcelona':'FC Barcelona',
    'Club Atl√©tico de Madrid':'Atletico Madrid','Atl√©tico de Madrid':'Atletico Madrid',
    'Athletic Club':'Athletic Club','Villarreal CF':'Villarreal',
    'RC Celta de Vigo':'Celta Vigo','Sevilla FC':'Sevilla',
    'Real Betis':'Real Betis','Real Sociedad':'Real Sociedad',
    // Serie A
    'FC Internazionale Milano':'Inter Milan','Inter':'Inter Milan',
    'SSC Napoli':'Napoli','Atalanta BC':'Atalanta','Juventus FC':'Juventus',
    'AC Milan':'AC Milan','SS Lazio':'Lazio','AS Roma':'AS Roma',
    'ACF Fiorentina':'Fiorentina','Como 1907':'Como',
    // Bundesliga
    'FC Bayern M√ºnchen':'Bayern Munich','Borussia Dortmund':'Borussia Dortmund',
    'VfB Stuttgart':'VfB Stuttgart','RasenBallsport Leipzig':'RB Leipzig',
    'Bayer 04 Leverkusen':'Bayer Leverkusen','Eintracht Frankfurt':'Eintracht Frankfurt',
    'SC Freiburg':'SC Freiburg','FC Augsburg':'FC Augsburg',
    'Hamburger SV':'Hamburger SV','1. FC K√∂ln':'1. FC K√∂ln',
    '1. FC Union Berlin':'Union Berlin',
    // Ligue 1
    'Paris Saint-Germain FC':'PSG','Paris Saint-Germain':'PSG',
    'RC Lens':'Lens','AS Monaco FC':'Monaco','AS Monaco':'Monaco',
    'Lille OSC':'Lille','Olympique Lyonnais':'Lyon','Olympique de Marseille':'Marseille',
    'Stade Rennais FC 1901':'Rennes','Stade Rennais FC':'Rennes',
    'OGC Nice':'Nice','Stade Brestois 29':'Brest',
  };
  return MAP[name] || name;
}

// football-data.org league codes
const FD_CODES = { pl:'PL', ll:'PD', sa:'SA', bl:'BL1', l1:'FL1' };

// Update status indicator helper
function setStatus(dotId, labelId, text, live) {
  const dot = document.getElementById(dotId);
  const lbl = document.getElementById(labelId);
  if (dot) dot.style.background = live ? 'var(--accent)' : '#f5c842';
  if (lbl) lbl.textContent = text;
}

// Fetch standings for one league from football-data.org
async function fdFetchStandings(leagueKey) {
  const code = FD_CODES[leagueKey];
  if (!code || !CONFIG.fdKey) return null;
  try {
    const d = await fdFetch(`/v4/competitions/${code}/standings`);
    if (!d) return null;
    const table = d.standings?.find(s => s.type === 'TOTAL')?.table;
    if (!table) return null;
    return table.map(row => ({
      pos:   row.position,
      team:  normTeam(row.team.shortName || row.team.name),
      P:     row.playedGames,
      W:     row.won, D: row.draw, L: row.lost,
      GF:    row.goalsFor, GA: row.goalsAgainst,
      GD:    row.goalDifference,
      pts:   row.points,
      form:  (row.form || '').replace(/,/g,'').slice(-5),
      zone:  row.position <= 4 ? 'cl' : row.position <= 6 ? 'el' : (row.position >= (leagueKey==='bl'?16:18) ? 'rel' : ''),
    }));
  } catch(e) { return null; }
}

// Fetch recent + upcoming matches for one league from football-data.org
async function fdFetchMatches(leagueKey) {
  const code = FD_CODES[leagueKey];
  if (!code || !CONFIG.fdKey) return null;
  try {
    // Get last 10 finished + next 10 scheduled
    const dateFrom = new Date(Date.now() - 14*86400000).toISOString().slice(0,10);
    const dateTo   = new Date(Date.now() + 14*86400000).toISOString().slice(0,10);
    const d = await fdFetch(`/v4/competitions/${code}/matches?dateFrom=${dateFrom}&dateTo=${dateTo}`);
    if (!d) return null;
    return (d.matches || []).map(m => ({
      home:   normTeam(m.homeTeam.shortName || m.homeTeam.name),
      away:   normTeam(m.awayTeam.shortName || m.awayTeam.name),
      date:   m.utcDate.slice(0,10),
      time:   m.utcDate.slice(11,16),
      week:   m.matchday,
      result: m.status === 'FINISHED' && m.score?.fullTime
                ? { h: m.score.fullTime.home, a: m.score.fullTime.away }
                : null,
      note:   '',
    }));
  } catch(e) { return null; }
}

// Fetch predictions/odds from Bzzoiro
async function bzFetchPredictions(leagueKey) {
  const bzId = LEAGUES[leagueKey]?.bzId;
  if (!bzId || !CONFIG.bzKey) return null;
  try {
    const r = await fetch(
      `https://sports.bzzoiro.com/api/predictions/?league=${bzId}&limit=5`,
      { headers: { 'Authorization': `Token ${CONFIG.bzKey}` } }
    );
    if (!r.ok) return null;
    const d = await r.json();
    return Array.isArray(d) ? d : (d.results || null);
  } catch(e) { return null; }
}

// Main live-data orchestrator
// ‚îÄ‚îÄ‚îÄ NETLIFY FUNCTION PROXY HELPER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// Calls /.netlify/functions/football-proxy which runs server-side,
// adds the API key header, and returns JSON directly ‚Äî no CORS issues.
async function fdFetch(path) {
  try {
    const r = await fetch('/.netlify/functions/football-proxy?path=' + encodeURIComponent(path));
    if (!r.ok) { console.warn('fdFetch: proxy HTTP', r.status); return null; }
    const parsed = await r.json();
    if (parsed.message) { console.warn('fdFetch API error:', parsed.message); return null; }
    return parsed;
  } catch(e) {
    console.warn('fdFetch exception:', e.message);
    return null;
  }
}
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

async function fetchLiveData() {
  let fdOk = false, bzOk = false;

  // ‚îÄ‚îÄ Football-Data.org: standings + fixtures for all leagues ‚îÄ‚îÄ
  for (const key of ['pl','ll','sa','bl','l1']) {
    const [standings, matches] = await Promise.all([
      fdFetchStandings(key),
      fdFetchMatches(key),
    ]);
    if (standings) {
      DEMO.standings[key] = standings;
      fdOk = true;
    }
    if (matches && matches.length) {
      // Keep our hand-verified results but prepend API matches as authoritative
      const apiResults   = matches.filter(m => m.result);
      const apiUpcoming  = matches.filter(m => !m.result);
      // Replace demo fixtures with live data (keeping any demo notes)
      if (apiResults.length || apiUpcoming.length) {
        DEMO.fixtures[key] = [...apiResults.slice(-8), ...apiUpcoming.slice(0,10)];
      }
      fdOk = true;
    }
  }

  // ‚îÄ‚îÄ Bzzoiro: predictions enrichment ‚îÄ‚îÄ
  for (const key of ['pl','ll','sa','bl','l1']) {
    const preds = await bzFetchPredictions(key);
    if (preds && preds.length) {
      bzOk = true;
      // Merge Bzzoiro predictions into the demo predictions list
      // (we keep demo predictions as fallback ‚Äî just mark as enhanced)
      DEMO.predictions = DEMO.predictions.map(p => {
        const bzMatch = preds.find(bz =>
          bz.home_team && normTeam(bz.home_team) === p.home &&
          bz.away_team && normTeam(bz.away_team) === p.away
        );
        if (bzMatch) {
          return {
            ...p,
            homeWin: Math.round((bzMatch.home_win_probability || p.homeWin/100)*100),
            draw:    Math.round((bzMatch.draw_probability    || p.draw/100)*100),
            awayWin: Math.round((bzMatch.away_win_probability || p.awayWin/100)*100),
            confidence: bzMatch.confidence_level || p.confidence,
            note: (p.note || '') + ' [Bzzoiro enhanced]',
          };
        }
        return p;
      });
    }
  }

  // Update status bar indicators
  if (fdOk) {
    setStatus('fdStatus','fdLabel','Football-Data.org ‚úì Live', true);
    console.log('%c‚öΩ Football-Data.org: LIVE DATA ACTIVE', 'color:#4ade80;font-weight:bold');
  } else {
    setStatus('fdStatus','fdLabel','Football-Data.org (check key)', false);
    console.warn('‚ö†Ô∏è football-data.org: no data returned. Key may be rate-limited or invalid. Check the ‚öô Configure panel ‚Üí üîç Test APIs Now');
  }
  if (bzOk) {
    setStatus('bzStatus','bzLabel','Bzzoiro Sports API ‚úì Live', true);
    console.log('%cüîÆ Bzzoiro Sports API: LIVE PREDICTIONS ACTIVE', 'color:#4ade80;font-weight:bold');
  } else {
    setStatus('bzStatus','bzLabel','Bzzoiro Sports API (fallback)', false);
    console.warn('‚ö†Ô∏è Bzzoiro API: predictions using verified data. Run diagnostics from ‚öô Configure to debug.');
  }

  // Re-render whatever tab is active
  if (fdOk || bzOk) {
    const tab = state.activeTab;
    if (tab === 'overview')   renderOverview();
    if (tab === 'fixtures')   renderFixtures();
    if (tab === 'standings')  renderStandings();
    if (tab === 'predictions') renderPredictions();
  }
}

// ============================================================
// INIT
// ============================================================

document.addEventListener('DOMContentLoaded', () => {
  renderTicker();
  renderOverview();
  
  // Fix nav tab click listeners
  document.querySelectorAll('.nav-tab').forEach(tab => {
    tab.addEventListener('click', function() {
      document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
      this.classList.add('active');
    });
  });

  // Start live data fetch
  setTimeout(fetchLiveData, 500);
  
  // Pre-fill API key fields from embedded keys
  document.getElementById('fdKey').value = CONFIG.fdKey;
  document.getElementById('bzKey').value = CONFIG.bzKey;

  // Show 'connecting' status immediately ‚Äî live fetch running
  setStatus('fdStatus','fdLabel','Football-Data.org ‚Äî Connecting‚Ä¶', false);
  setStatus('bzStatus','bzLabel','Bzzoiro Sports API ‚Äî Connecting‚Ä¶', false);

  console.log('‚öΩ Football Oracle ‚Äî 2025-26 Season Analytics');
  console.log('üîë football-data.org key:', CONFIG.fdKey ? '‚úì set' : '‚úó missing');
  console.log('üîë Bzzoiro Sports key:', CONFIG.bzKey ? '‚úì set' : '‚úó missing');
  console.log('üì° Fetching live data from both APIs...');
});
</script>
</body>
</html>
